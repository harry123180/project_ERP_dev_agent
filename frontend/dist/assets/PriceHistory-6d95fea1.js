import{d as X,r as v,a1 as Q,c as Z,b as u,e as t,w as l,X as k,m as ee,E as te,aw as le,ax as ae,T as oe,o as ie,g as _,ay as ne,i as n,ap as re,t as s,aq as $,b2 as ue,I as se,j as pe,k as de,ah as me,ai as _e,aF as ce,au as ve,av as fe,ao as be,aJ as ge,aK as ye,b3 as Ce,aj as we,a4 as De,aO as Pe,_ as Ve}from"./index-61294aba.js";/* empty css                 *//* empty css               *//* empty css                     *//* empty css                             *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css                             *//* empty css                  *//* empty css                        */import{f as P,a as Y}from"./format-8036aac9.js";const xe={class:"price-history"},Ee={class:"page-header"},ke={class:"header-actions"},Te={class:"filters"},Me={class:"table-container"},he={class:"pagination"},ze={class:"trend-chart-container"},Ie={class:"chart-placeholder"},Re={class:"price-statistics"},Ne={class:"development-notice"},Ue=X({__name:"PriceHistory",setup($e){const V=v(!1),T=v([]),w=v(!1),g=v(!1),r=v({}),o=v({itemCode:"",itemName:"",supplier:"",minPrice:null,maxPrice:null,dateRange:[]}),c=v({page:1,size:20,total:0}),q=[{id:"1",item_code:"IC001",item_name:"半導體材料A",supplier_name:"台積電材料供應商",unit_price:150,currency:"TWD",quantity:100,total_amount:15e3,purchase_date:"2025-01-05",po_number:"PO202501001",price_trend:"up",max_price:180,min_price:120,avg_price:145},{id:"2",item_code:"MC002",item_name:"精密零件B",supplier_name:"精密機械公司",unit_price:250,currency:"TWD",quantity:50,total_amount:12500,purchase_date:"2025-01-03",po_number:"PO202501002",price_trend:"down",max_price:280,min_price:240,avg_price:255},{id:"3",item_code:"EC003",item_name:"IC晶片套裝",supplier_name:"電子元件供應商",unit_price:500,currency:"TWD",quantity:20,total_amount:1e4,purchase_date:"2025-01-01",po_number:"PO202501003",price_trend:"stable",max_price:520,min_price:480,avg_price:500},{id:"4",item_code:"IC001",item_name:"半導體材料A",supplier_name:"台積電材料供應商",unit_price:145,currency:"TWD",quantity:150,total_amount:21750,purchase_date:"2024-12-20",po_number:"PO202412020",price_trend:"stable",max_price:180,min_price:120,avg_price:145}],f=async()=>{V.value=!0;try{await new Promise(e=>setTimeout(e,500));let i=[...q];if(o.value.itemCode&&(i=i.filter(e=>e.item_code.toLowerCase().includes(o.value.itemCode.toLowerCase()))),o.value.itemName&&(i=i.filter(e=>e.item_name.toLowerCase().includes(o.value.itemName.toLowerCase()))),o.value.supplier&&(i=i.filter(e=>e.supplier_name.includes(o.value.supplier))),o.value.minPrice!==null&&(i=i.filter(e=>e.unit_price>=o.value.minPrice)),o.value.maxPrice!==null&&(i=i.filter(e=>e.unit_price<=o.value.maxPrice)),o.value.dateRange&&o.value.dateRange.length===2){const[e,y]=o.value.dateRange;i=i.filter(p=>{const C=new Date(p.purchase_date);return C>=new Date(e)&&C<=new Date(y)})}T.value=i,c.value.total=i.length}catch(i){console.error("載入價格歷史失敗:",i),k.error("載入價格歷史失敗")}finally{V.value=!1}},O=()=>{o.value={itemCode:"",itemName:"",supplier:"",minPrice:null,maxPrice:null,dateRange:[]},c.value.page=1,f()},S=()=>{f(),k.success("資料已重新整理")},A=()=>{k.success("價格資料匯出功能開發中")},M=i=>{r.value=i,g.value=!0},h=i=>{r.value=i,w.value=!0,g.value=!1},z=i=>({up:"danger",down:"success",stable:"info"})[i]||"",I=i=>({up:"上漲",down:"下跌",stable:"穩定"})[i]||i;return Q(()=>{f()}),(i,e)=>{const y=se,p=ee,C=pe,b=de,D=me,B=_e,R=ce,H=ve,W=te,d=fe,N=be,j=le,F=ae,U=oe,m=ge,L=ye,x=Ce,E=we,K=De,G=Pe;return ie(),Z("div",xe,[u("div",Ee,[e[15]||(e[15]=u("h1",{class:"page-title"},"歷史價格查詢",-1)),u("div",ke,[t(p,{type:"success",onClick:A},{default:l(()=>[t(y,null,{default:l(()=>[t(_(ne))]),_:1}),e[13]||(e[13]=n(" 匯出資料 ",-1))]),_:1}),t(p,{type:"primary",onClick:S},{default:l(()=>[t(y,null,{default:l(()=>[t(_(re))]),_:1}),e[14]||(e[14]=n(" 重新整理 ",-1))]),_:1})])]),u("div",Te,[t(W,{model:o.value,inline:""},{default:l(()=>[t(b,{label:"品項編號"},{default:l(()=>[t(C,{modelValue:o.value.itemCode,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.itemCode=a),placeholder:"輸入品項編號",clearable:""},null,8,["modelValue"])]),_:1}),t(b,{label:"品項名稱"},{default:l(()=>[t(C,{modelValue:o.value.itemName,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.itemName=a),placeholder:"輸入品項名稱",clearable:""},null,8,["modelValue"])]),_:1}),t(b,{label:"供應商"},{default:l(()=>[t(B,{modelValue:o.value.supplier,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.supplier=a),placeholder:"選擇供應商",clearable:""},{default:l(()=>[t(D,{label:"全部",value:""}),t(D,{label:"台積電材料供應商",value:"supplier_a"}),t(D,{label:"精密機械公司",value:"supplier_b"}),t(D,{label:"電子元件供應商",value:"supplier_c"})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"價格區間"},{default:l(()=>[t(R,{modelValue:o.value.minPrice,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.minPrice=a),placeholder:"最低價格",min:0,"controls-position":"right"},null,8,["modelValue"]),e[16]||(e[16]=u("span",{style:{margin:"0 8px"}},"~",-1)),t(R,{modelValue:o.value.maxPrice,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.maxPrice=a),placeholder:"最高價格",min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1}),t(b,{label:"時間範圍"},{default:l(()=>[t(H,{modelValue:o.value.dateRange,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.dateRange=a),type:"daterange","start-placeholder":"開始日期","end-placeholder":"結束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(b,null,{default:l(()=>[t(p,{type:"primary",onClick:f},{default:l(()=>[...e[17]||(e[17]=[n("搜尋",-1)])]),_:1}),t(p,{onClick:O},{default:l(()=>[...e[18]||(e[18]=[n("重設",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),u("div",Me,[t(j,{data:T.value,loading:V.value,stripe:"",onRowClick:M},{default:l(()=>[t(d,{prop:"item_code",label:"品項編號",width:"120"}),t(d,{prop:"item_name",label:"品項名稱",width:"200"}),t(d,{prop:"supplier_name",label:"供應商",width:"180"}),t(d,{prop:"unit_price",label:"單價",width:"100"},{default:l(({row:a})=>[n(s(_(P)(a.unit_price)),1)]),_:1}),t(d,{prop:"currency",label:"幣別",width:"80"}),t(d,{prop:"quantity",label:"採購數量",width:"100"}),t(d,{prop:"total_amount",label:"總金額",width:"120"},{default:l(({row:a})=>[n(s(_(P)(a.total_amount)),1)]),_:1}),t(d,{prop:"purchase_date",label:"採購日期",width:"120"},{default:l(({row:a})=>[n(s(_(Y)(a.purchase_date)),1)]),_:1}),t(d,{prop:"po_number",label:"採購單號",width:"140"}),t(d,{prop:"price_trend",label:"價格趨勢",width:"100"},{default:l(({row:a})=>[t(N,{type:z(a.price_trend)},{default:l(()=>[n(s(I(a.price_trend)),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"操作",width:"120"},{default:l(({row:a})=>[t(p,{size:"small",onClick:$(J=>M(a),["stop"])},{default:l(()=>[...e[19]||(e[19]=[n("詳情",-1)])]),_:1},8,["onClick"]),t(p,{size:"small",type:"primary",onClick:$(J=>h(a),["stop"])},{default:l(()=>[...e[20]||(e[20]=[n(" 趨勢圖 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading"]),u("div",he,[t(F,{"current-page":c.value.page,"onUpdate:currentPage":e[6]||(e[6]=a=>c.value.page=a),"page-size":c.value.size,"onUpdate:pageSize":e[7]||(e[7]=a=>c.value.size=a),total:c.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:f,onCurrentChange:f},null,8,["current-page","page-size","total"])])]),t(U,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=a=>w.value=a),title:`${r.value.item_name} - 價格趨勢圖`,width:"800px"},{footer:l(()=>[t(p,{onClick:e[8]||(e[8]=a=>w.value=!1)},{default:l(()=>[...e[23]||(e[23]=[n("關閉",-1)])]),_:1})]),default:l(()=>[u("div",ze,[u("div",Ie,[t(y,{class:"chart-icon"},{default:l(()=>[t(_(ue))]),_:1}),e[21]||(e[21]=u("p",null,"價格趨勢圖表將在此顯示",-1)),e[22]||(e[22]=u("p",{class:"chart-description"}," 顯示該品項在不同時間點的價格變化趨勢，包含最高價、最低價、平均價等統計資訊 ",-1))])])]),_:1},8,["modelValue","title"]),t(U,{modelValue:g.value,"onUpdate:modelValue":e[12]||(e[12]=a=>g.value=a),title:"價格詳情",width:"600px"},{footer:l(()=>[t(p,{onClick:e[10]||(e[10]=a=>g.value=!1)},{default:l(()=>[...e[25]||(e[25]=[n("關閉",-1)])]),_:1}),t(p,{type:"primary",onClick:e[11]||(e[11]=a=>h(r.value))},{default:l(()=>[...e[26]||(e[26]=[n("查看趨勢圖",-1)])]),_:1})]),default:l(()=>[t(L,{column:2,border:""},{default:l(()=>[t(m,{label:"品項編號"},{default:l(()=>[n(s(r.value.item_code),1)]),_:1}),t(m,{label:"品項名稱"},{default:l(()=>[n(s(r.value.item_name),1)]),_:1}),t(m,{label:"供應商"},{default:l(()=>[n(s(r.value.supplier_name),1)]),_:1}),t(m,{label:"採購單號"},{default:l(()=>[n(s(r.value.po_number),1)]),_:1}),t(m,{label:"單價"},{default:l(()=>[n(s(_(P)(r.value.unit_price)),1)]),_:1}),t(m,{label:"幣別"},{default:l(()=>[n(s(r.value.currency),1)]),_:1}),t(m,{label:"採購數量"},{default:l(()=>[n(s(r.value.quantity),1)]),_:1}),t(m,{label:"總金額"},{default:l(()=>[n(s(_(P)(r.value.total_amount)),1)]),_:1}),t(m,{label:"採購日期"},{default:l(()=>[n(s(_(Y)(r.value.purchase_date)),1)]),_:1}),t(m,{label:"價格趨勢"},{default:l(()=>[t(N,{type:z(r.value.price_trend)},{default:l(()=>[n(s(I(r.value.price_trend)),1)]),_:1},8,["type"])]),_:1})]),_:1}),u("div",Re,[e[24]||(e[24]=u("h4",null,"價格統計資訊",-1)),t(K,{gutter:20},{default:l(()=>[t(E,{span:8},{default:l(()=>[t(x,{title:"歷史最高價",value:r.value.max_price,precision:2,prefix:"$"},null,8,["value"])]),_:1}),t(E,{span:8},{default:l(()=>[t(x,{title:"歷史最低價",value:r.value.min_price,precision:2,prefix:"$"},null,8,["value"])]),_:1}),t(E,{span:8},{default:l(()=>[t(x,{title:"平均價格",value:r.value.avg_price,precision:2,prefix:"$"},null,8,["value"])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),u("div",Ne,[t(G,{title:"功能開發中",description:"歷史價格查詢功能正在開發中，目前顯示的是模擬資料。完整功能將包含價格趨勢分析、供應商比價、價格預測等。",type:"info","show-icon":"",closable:!1})])])}}});const lt=Ve(Ue,[["__scopeId","data-v-d573edfe"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/purchase-orders/PriceHistory.vue"]]);export{lt as default};
//# sourceMappingURL=PriceHistory-6d95fea1.js.map
