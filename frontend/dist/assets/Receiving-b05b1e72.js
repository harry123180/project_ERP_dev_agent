import{d as Ye,y as Ae,u as Oe,r as g,a as te,p as j,a1 as Pe,c as b,b as s,e,w as t,Y as B,X as C,al as je,a4 as Be,T as We,o as c,g as D,ap as Ne,i as n,F as ye,s as ge,q as W,a9 as He,t as i,b8 as Qe,aa as Ke,ad as Ge,ba as Je,aH as he,aP as Xe,ab as E,aq as le,ac as Ze,I as et,m as tt,j as lt,k as at,ah as st,ai as it,au as nt,E as ot,aj as dt,av as ut,aQ as rt,aJ as ct,aK as _t,ao as pt,aw as vt,aE as mt,aO as ft,aS as bt,_ as yt}from"./index-61294aba.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css                             *//* empty css                *//* empty css               *//* empty css                *//* empty css                     *//* empty css                             *//* empty css                 *//* empty css                  *//* empty css                  */const gt={class:"receiving-management"},ht={class:"filter-section"},kt={class:"card-header"},wt={class:"stats-section"},xt={class:"stat-item"},Vt={class:"stat-value"},Ct={class:"statistic-icon pending"},Dt={class:"stat-item"},Et={class:"stat-value"},zt={class:"statistic-icon arrived"},It={class:"stat-item"},St={class:"stat-value"},qt={class:"statistic-icon delayed"},Rt={class:"stat-item"},Mt={class:"stat-value"},$t={class:"statistic-icon this-month"},Ft={class:"receiving-list"},Tt={class:"card-header"},Ut={key:0,class:"desktop-table"},Lt={class:"expand-content"},Yt={key:0},At={key:1,class:"no-data"},Ot={class:"item-primary-info"},Pt={class:"item-name"},jt={class:"item-meta"},Bt={class:"spec-preview"},Wt={class:"order-info"},Nt={class:"order-numbers"},Ht={class:"order-item"},Qt={key:0,class:"order-item"},Kt={class:"order-value"},Gt={class:"supplier-status-info"},Jt={class:"supplier-name"},Xt={class:"status-delivery"},Zt={class:"delivery-timing"},el={class:"expected-date"},tl={class:"overdue-status"},ll={key:0,class:"overdue-text"},al={key:1,class:"on-time-text"},sl={class:"action-buttons"},il={key:1,class:"mobile-cards"},nl={class:"mobile-actions"},ol={class:"receiving-cards"},dl={class:"card-header"},ul={class:"item-name"},rl={class:"card-content"},cl={class:"info-row"},_l={class:"info-row"},pl={class:"info-row"},vl={class:"value"},ml={class:"info-row"},fl={key:0,class:"info-row"},bl={class:"value"},yl={key:1,class:"info-row"},gl={class:"value spec-text"},hl={key:2,class:"info-row"},kl={class:"value"},wl={key:0,class:"receiving-detail"},xl={class:"item-info"},Vl={class:"receiving-form"},Cl={class:"batch-receive-content"},Dl={class:"selected-items"},El={key:0,class:"item-detail"},zl={key:0,class:"overdue-text"},Il={key:1,class:"on-time-text"},Sl={key:0,class:"receipt-history"},ql=Ye({__name:"Receiving",setup(Rl){const ae=Ae(),ke=Oe(),U=g(!1),N=g(!1),H=g(!1),y=g([]),_=g([]),se=g([]),L=g(!1),r=g(null),ie=g(),M=te({notes:""}),we={},ne=g(window.innerWidth),xe=j(()=>ne.value<768),Q=g(!1),Ve=j(()=>_.value.length>0&&_.value.length<y.value.length),m=te({supplier_id:"",po_number:"",consolidation_number:"",status:"",expected_date:""}),Y=j(()=>{const o=new Date,l=o.getMonth();return{pendingItems:y.value.filter(d=>d.delivery_status==="已發貨"||d.delivery_status==="運送中").length,arrivedItems:y.value.filter(d=>d.delivery_status==="已到貨"||d.delivery_status==="最後一哩").length,delayedItems:y.value.filter(d=>S(d.expected_delivery_date)>0).length,thisMonthItems:y.value.filter(d=>{if(!d.received_at)return!1;const v=new Date(d.received_at);return v.getMonth()===l&&v.getFullYear()===o.getFullYear()}).length}}),$=g(!1),F=g(!1),p=g(null),A=j(()=>{var o;return((o=ke.currentUser)==null?void 0:o.chinese_name)||""}),h=te({receiver:"",received_time:new Date,notes:""}),I=async()=>{try{U.value=!0;const o={po_number:m.po_number,consolidation_number:m.consolidation_number,supplier_id:m.supplier_id},l=await B.getShippedItems(o);y.value=l}catch(o){console.error("Failed to load receiving list:",o),C.error("載入收貨列表失敗")}finally{U.value=!1}},oe=async()=>{try{se.value=await B.getSuppliers()}catch(o){console.error("Failed to load suppliers:",o),C.error("載入供應商列表失敗")}},Ce=()=>{I(),oe()},De=o=>{_.value=o,ue()},Ee=o=>{o?_.value=[...y.value]:_.value=[]},de=o=>{const l=_.value.findIndex(d=>d.id===o.id);l>-1?_.value.splice(l,1):_.value.push(o),ue()},ue=()=>{Q.value=_.value.length===y.value.length},re=()=>{ne.value=window.innerWidth},K=async o=>{p.value=o,M.notes="",$.value=!0},ze=async()=>{try{await ie.value.validate(),N.value=!0;const o={item_id:p.value.id,item_name:p.value.item_name,requisition_number:p.value.requisition_number,purchase_order_number:p.value.purchase_order_number,consolidation_number:p.value.consolidation_number,quantity:p.value.quantity,unit:p.value.unit,receiver:A.value,received_at:new Date().toISOString(),notes:M.notes};await B.confirmItemReceived(o),C.success("物料收貨確認成功，已加入待入庫列表"),$.value=!1;const l=p.value.id;y.value=y.value.filter(d=>d.id!==l),p.value=null,await I()}catch(o){console.error("Failed to confirm receiving:",o),C.error("確認收貨失敗")}finally{N.value=!1}},ce=()=>{if(_.value.length===0){C.warning("請選擇要批量收貨的品項");return}h.receiver=A.value,h.received_time=new Date,h.notes="",F.value=!0},Ie=async()=>{try{H.value=!0;const o={items:_.value.map(d=>({item_id:d.id,requisition_number:d.requisition_number,purchase_order_number:d.purchase_order_number,consolidation_number:d.consolidation_number})),receiver:h.receiver,received_at:h.received_time.toISOString(),notes:h.notes};await B.batchConfirmReceived(o),C.success({message:`成功批量收貨 ${_.value.length} 個品項！已全部加入待入庫列表，請至儲位管理分配儲位。`,duration:5e3,showClose:!0}),F.value=!1;const l=_.value.map(d=>d.id);y.value=y.value.filter(d=>!l.includes(d.id)),_.value=[],await I()}catch(o){console.error("Failed to batch confirm receiving:",o),C.error("批量收貨失敗")}finally{H.value=!1}},G=o=>{ae.push(`/purchase-orders/${o}`)},Se=o=>{ae.push(`/requisitions/${o}`)},T=o=>({已發貨:"success",運送中:"warning",海運中:"info",清關中:"warning",最後一哩:"success",即將到達:"success",延遲:"danger",異常:"danger"})[o]||"info",J=o=>new Date(o).toLocaleDateString("zh-TW"),qe=o=>(typeof o=="string"?new Date(o):o).toLocaleString("zh-TW"),S=o=>{if(!o)return 0;const l=new Date(o),d=new Date;d.setHours(0,0,0,0),l.setHours(0,0,0,0);const v=d.getTime()-l.getTime(),V=Math.ceil(v/(1e3*60*60*24));return V>0?V:0},Re=()=>{m.supplier_id="",m.po_number="",m.consolidation_number="",m.status="",m.expected_date="",I()},Me=o=>{r.value=o,L.value=!0},$e=o=>{C.info("更新交期功能開發中")},Fe=o=>({good:"success",minor_defect:"warning",major_defect:"danger",rejected:"danger"})[o]||"",Te=o=>({good:"良好",minor_defect:"輕微瑕疵",major_defect:"重大瑕疵",rejected:"不合格"})[o]||o;Pe(()=>{I(),oe(),window.addEventListener("resize",re)});const Ue=()=>{window.removeEventListener("resize",re)};return typeof window<"u"&&window.addEventListener("beforeunload",Ue),(o,l)=>{var be;const d=et,v=tt,V=lt,w=at,q=st,_e=it,pe=nt,X=ot,z=je,R=dt,ve=Be,f=ut,O=rt,u=ct,P=_t,k=pt,Z=vt,me=mt,fe=ft,ee=We,Le=bt;return c(),b("div",gt,[s("div",ht,[e(z,null,{header:t(()=>[s("div",kt,[l[19]||(l[19]=s("span",null,"收貨管理 - 統一收貨作業",-1)),e(v,{type:"primary",onClick:Ce},{default:t(()=>[e(d,null,{default:t(()=>[e(D(Ne))]),_:1}),l[18]||(l[18]=n(" 重新整理 ",-1))]),_:1})])]),default:t(()=>[e(X,{inline:!0,model:m},{default:t(()=>[e(w,{label:"採購單號"},{default:t(()=>[e(V,{modelValue:m.po_number,"onUpdate:modelValue":l[0]||(l[0]=a=>m.po_number=a),placeholder:"輸入採購單號",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(w,{label:"集運單號"},{default:t(()=>[e(V,{modelValue:m.consolidation_number,"onUpdate:modelValue":l[1]||(l[1]=a=>m.consolidation_number=a),placeholder:"輸入集運單號",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(w,{label:"供應商"},{default:t(()=>[e(_e,{modelValue:m.supplier_id,"onUpdate:modelValue":l[2]||(l[2]=a=>m.supplier_id=a),placeholder:"選擇供應商",clearable:"",style:{width:"200px"}},{default:t(()=>[(c(!0),b(ye,null,ge(se.value,a=>(c(),W(q,{key:a.supplier_id,label:a.supplier_name_zh,value:a.supplier_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"收貨狀態"},{default:t(()=>[e(_e,{modelValue:m.status,"onUpdate:modelValue":l[3]||(l[3]=a=>m.status=a),placeholder:"選擇狀態",clearable:"",style:{width:"150px"}},{default:t(()=>[e(q,{label:"全部",value:""}),e(q,{label:"待收貨",value:"pending"}),e(q,{label:"已到貨",value:"arrived"}),e(q,{label:"部分收貨",value:"partial"}),e(q,{label:"延期到貨",value:"delayed"})]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"預計到貨日"},{default:t(()=>[e(pe,{modelValue:m.expected_date,"onUpdate:modelValue":l[4]||(l[4]=a=>m.expected_date=a),type:"date",placeholder:"選擇日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"160px"}},null,8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(v,{type:"primary",onClick:I,loading:U.value},{default:t(()=>[e(d,null,{default:t(()=>[e(D(He))]),_:1}),l[20]||(l[20]=n(" 查詢 ",-1))]),_:1},8,["loading"]),e(v,{onClick:Re},{default:t(()=>[...l[21]||(l[21]=[n("重設",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),s("div",wt,[e(ve,{gutter:20},{default:t(()=>[e(R,{span:6},{default:t(()=>[e(z,{class:"stat-card"},{default:t(()=>[s("div",xt,[s("div",Vt,i(Y.value.pendingItems),1),l[22]||(l[22]=s("div",{class:"stat-label"},"待收貨品項",-1)),s("div",Ct,[e(d,null,{default:t(()=>[e(D(Qe))]),_:1})])])]),_:1})]),_:1}),e(R,{span:6},{default:t(()=>[e(z,{class:"stat-card"},{default:t(()=>[s("div",Dt,[s("div",Et,i(Y.value.arrivedItems),1),l[23]||(l[23]=s("div",{class:"stat-label"},"已到貨品項",-1)),s("div",zt,[e(d,null,{default:t(()=>[e(D(Ke))]),_:1})])])]),_:1})]),_:1}),e(R,{span:6},{default:t(()=>[e(z,{class:"stat-card"},{default:t(()=>[s("div",It,[s("div",St,i(Y.value.delayedItems),1),l[24]||(l[24]=s("div",{class:"stat-label"},"延期品項",-1)),s("div",qt,[e(d,null,{default:t(()=>[e(D(Ge))]),_:1})])])]),_:1})]),_:1}),e(R,{span:6},{default:t(()=>[e(z,{class:"stat-card"},{default:t(()=>[s("div",Rt,[s("div",Mt,i(Y.value.thisMonthItems),1),l[25]||(l[25]=s("div",{class:"stat-label"},"本月收貨",-1)),s("div",$t,[e(d,null,{default:t(()=>[e(D(Je))]),_:1})])])]),_:1})]),_:1})]),_:1})]),s("div",Ft,[e(z,null,{header:t(()=>[s("div",Tt,[s("span",null,"已發貨待收貨品項 ("+i(y.value.length)+" 項)",1),s("div",null,[e(v,{size:"small",onClick:ce,disabled:!_.value.length,type:"success"},{default:t(()=>[e(d,null,{default:t(()=>[e(D(he))]),_:1}),l[26]||(l[26]=n(" 批量收貨 ",-1))]),_:1},8,["disabled"])])])]),default:t(()=>[xe.value?(c(),b("div",il,[s("div",nl,[e(me,{modelValue:Q.value,"onUpdate:modelValue":l[5]||(l[5]=a=>Q.value=a),onChange:Ee,indeterminate:Ve.value},{default:t(()=>[...l[32]||(l[32]=[n(" 全選 ",-1)])]),_:1},8,["modelValue","indeterminate"]),e(v,{size:"small",onClick:ce,disabled:!_.value.length,type:"success"},{default:t(()=>[n(" 批量收貨 ("+i(_.value.length)+") ",1)]),_:1},8,["disabled"])]),s("div",ol,[(c(!0),b(ye,null,ge(y.value,a=>(c(),W(z,{key:a.id,class:Ze(["receiving-card",{selected:_.value.includes(a)}]),onClick:x=>de(a)},{default:t(()=>[s("div",dl,[e(me,{"model-value":_.value.includes(a),onClick:l[6]||(l[6]=le(()=>{},["stop"])),onChange:x=>de(a)},null,8,["model-value","onChange"]),s("div",ul,i(a.item_name),1),e(v,{size:"small",type:"success",onClick:le(x=>K(a),["stop"])},{default:t(()=>[...l[33]||(l[33]=[n(" 收貨 ",-1)])]),_:1},8,["onClick"])]),s("div",rl,[s("div",cl,[l[34]||(l[34]=s("span",{class:"label"},"數量:",-1)),e(k,{size:"small",type:"info"},{default:t(()=>[n(i(a.quantity)+" "+i(a.unit),1)]),_:2},1024)]),s("div",_l,[l[35]||(l[35]=s("span",{class:"label"},"狀態:",-1)),e(k,{type:T(a.delivery_status),size:"small"},{default:t(()=>[n(i(a.delivery_status),1)]),_:2},1032,["type"])]),s("div",pl,[l[36]||(l[36]=s("span",{class:"label"},"供應商:",-1)),s("span",vl,i(a.supplier_name),1),e(k,{size:"small",type:a.supplier_region==="domestic"?"success":"warning"},{default:t(()=>[n(i(a.supplier_region==="domestic"?"國內":"國外"),1)]),_:2},1032,["type"])]),s("div",ml,[l[37]||(l[37]=s("span",{class:"label"},"採購單:",-1)),e(O,{type:"primary",onClick:le(x=>G(a.purchase_order_number),["stop"])},{default:t(()=>[n(i(a.purchase_order_number),1)]),_:2},1032,["onClick"])]),a.consolidation_number?(c(),b("div",fl,[l[38]||(l[38]=s("span",{class:"label"},"集運單:",-1)),s("span",bl,i(a.consolidation_number),1)])):E("",!0),a.specification?(c(),b("div",yl,[l[39]||(l[39]=s("span",{class:"label"},"規格:",-1)),s("span",gl,i(a.specification),1)])):E("",!0),a.remarks?(c(),b("div",hl,[l[40]||(l[40]=s("span",{class:"label"},"備註:",-1)),s("span",kl,i(a.remarks),1)])):E("",!0)])]),_:2},1032,["class","onClick"]))),128))])])):(c(),b("div",Ut,[Xe((c(),W(Z,{data:y.value,onSelectionChange:De,stripe:"","default-expand-all":!1,"row-key":"id"},{default:t(()=>[e(f,{type:"selection",width:"55"}),e(f,{type:"expand",width:"50"},{default:t(({row:a})=>[s("div",Lt,[e(ve,{gutter:20},{default:t(()=>[e(R,{span:12},{default:t(()=>[e(P,{column:1,border:"",size:"small"},{default:t(()=>[e(u,{label:"請購單號"},{default:t(()=>[e(O,{type:"primary",onClick:x=>Se(a.requisition_number)},{default:t(()=>[n(i(a.requisition_number),1)]),_:2},1032,["onClick"])]),_:2},1024),e(u,{label:"採購單號"},{default:t(()=>[e(O,{type:"primary",onClick:x=>G(a.purchase_order_number)},{default:t(()=>[n(i(a.purchase_order_number),1)]),_:2},1032,["onClick"])]),_:2},1024),e(u,{label:"集運單號"},{default:t(()=>[a.consolidation_number?(c(),b("span",Yt,i(a.consolidation_number),1)):(c(),b("span",At,"-"))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(R,{span:12},{default:t(()=>[e(P,{column:1,border:"",size:"small"},{default:t(()=>[e(u,{label:"完整規格"},{default:t(()=>[n(i(a.specification||"-"),1)]),_:2},1024),e(u,{label:"備註"},{default:t(()=>[n(i(a.remarks||"-"),1)]),_:2},1024),e(u,{label:"供應商地區"},{default:t(()=>[e(k,{size:"small",type:a.supplier_region==="domestic"?"success":"warning"},{default:t(()=>[n(i(a.supplier_region==="domestic"?"國內供應商":"國外供應商"),1)]),_:2},1032,["type"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:1}),e(f,{label:"品項信息","min-width":"300"},{default:t(({row:a})=>[s("div",Ot,[s("div",Pt,i(a.item_name),1),s("div",jt,[e(k,{size:"small",type:"info"},{default:t(()=>[n(i(a.quantity)+" "+i(a.unit),1)]),_:2},1024),s("span",Bt,i((a.specification||"").substring(0,20))+i((a.specification||"").length>20?"...":""),1)])])]),_:1}),e(f,{label:"單據信息","min-width":"200"},{default:t(({row:a})=>[s("div",Wt,[s("div",Nt,[s("div",Ht,[l[27]||(l[27]=s("span",{class:"order-label"},"PO:",-1)),e(O,{type:"primary",onClick:x=>G(a.purchase_order_number),class:"order-link"},{default:t(()=>[n(i(a.purchase_order_number),1)]),_:2},1032,["onClick"])]),a.consolidation_number?(c(),b("div",Qt,[l[28]||(l[28]=s("span",{class:"order-label"},"集運:",-1)),s("span",Kt,i(a.consolidation_number),1)])):E("",!0)])])]),_:1}),e(f,{label:"供應商 & 狀態","min-width":"200"},{default:t(({row:a})=>[s("div",Gt,[s("div",Jt,i(a.supplier_name),1),s("div",Xt,[e(k,{type:T(a.delivery_status),size:"small"},{default:t(()=>[n(i(a.delivery_status),1)]),_:2},1032,["type"])])])]),_:1}),e(f,{label:"預計到貨 & 延期","min-width":"180"},{default:t(({row:a})=>[s("div",Zt,[s("div",el,i(a.expected_delivery_date?J(a.expected_delivery_date):"-"),1),s("div",tl,[S(a.expected_delivery_date)>0?(c(),b("span",ll," 延期 "+i(S(a.expected_delivery_date))+" 天 ",1)):(c(),b("span",al,"準時"))])])]),_:1}),e(f,{label:"操作",width:"180",fixed:"right"},{default:t(({row:a})=>[s("div",sl,[e(v,{size:"small",type:"success",onClick:x=>K(a)},{default:t(()=>[e(d,null,{default:t(()=>[e(D(he))]),_:1}),l[29]||(l[29]=n(" 收貨 ",-1))]),_:1},8,["onClick"]),e(v,{size:"small",type:"primary",onClick:x=>Me(a)},{default:t(()=>[...l[30]||(l[30]=[n(" 詳情 ",-1)])]),_:1},8,["onClick"]),S(a.expected_delivery_date)>0?(c(),W(v,{key:0,size:"small",type:"warning",onClick:x=>$e(a)},{default:t(()=>[...l[31]||(l[31]=[n(" 更新交期 ",-1)])]),_:1},8,["onClick"])):E("",!0)])]),_:1})]),_:1},8,["data"])),[[Le,U.value]])]))]),_:1})]),e(ee,{modelValue:$.value,"onUpdate:modelValue":l[9]||(l[9]=a=>$.value=a),title:"收貨確認",width:"600px"},{footer:t(()=>[e(v,{onClick:l[8]||(l[8]=a=>$.value=!1)},{default:t(()=>[...l[41]||(l[41]=[n("取消",-1)])]),_:1}),e(v,{type:"primary",onClick:ze,loading:N.value},{default:t(()=>[...l[42]||(l[42]=[n("確認收貨",-1)])]),_:1},8,["loading"])]),default:t(()=>[p.value?(c(),b("div",wl,[s("div",xl,[e(P,{column:2,border:""},{default:t(()=>[e(u,{label:"品名"},{default:t(()=>[n(i(p.value.item_name),1)]),_:1}),e(u,{label:"規格"},{default:t(()=>[n(i(p.value.specification),1)]),_:1}),e(u,{label:"數量"},{default:t(()=>[n(i(p.value.quantity)+" "+i(p.value.unit),1)]),_:1}),e(u,{label:"請購單號"},{default:t(()=>[n(i(p.value.requisition_number),1)]),_:1}),e(u,{label:"採購單號"},{default:t(()=>[n(i(p.value.purchase_order_number),1)]),_:1}),e(u,{label:"集運單號"},{default:t(()=>[n(i(p.value.consolidation_number||"-"),1)]),_:1}),e(u,{label:"供應商"},{default:t(()=>[n(i(p.value.supplier_name),1)]),_:1}),e(u,{label:"物流狀態"},{default:t(()=>[e(k,{type:T(p.value.delivery_status),size:"small"},{default:t(()=>[n(i(p.value.delivery_status),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"收貨人"},{default:t(()=>[n(i(A.value),1)]),_:1}),e(u,{label:"收貨時間",span:2},{default:t(()=>[n(i(qe(new Date)),1)]),_:1})]),_:1})]),s("div",Vl,[e(fe,{title:"收貨後將自動加入到儲位管理的待入庫物料列表",type:"info","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}}),e(X,{model:M,rules:we,ref_key:"receivingFormRef",ref:ie,"label-width":"120px"},{default:t(()=>[e(w,{label:"收貨備註"},{default:t(()=>[e(V,{modelValue:M.notes,"onUpdate:modelValue":l[7]||(l[7]=a=>M.notes=a),type:"textarea",rows:"3",placeholder:"記錄收貨狀況、問題或其他備註...",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])])):E("",!0)]),_:1},8,["modelValue"]),e(ee,{modelValue:F.value,"onUpdate:modelValue":l[14]||(l[14]=a=>F.value=a),title:"批量收貨",width:"700px"},{footer:t(()=>[e(v,{onClick:l[13]||(l[13]=a=>F.value=!1)},{default:t(()=>[...l[44]||(l[44]=[n("取消",-1)])]),_:1}),e(v,{type:"primary",onClick:Ie,loading:H.value},{default:t(()=>[...l[45]||(l[45]=[n("確認收貨",-1)])]),_:1},8,["loading"])]),default:t(()=>[s("div",Cl,[e(fe,{title:"批量收貨確認",type:"warning","show-icon":""},{default:t(()=>[n(" 您即將確認以下 "+i(_.value.length)+" 項已發貨物料已收貨。 ",1)]),_:1}),s("div",Dl,[l[43]||(l[43]=s("h4",null,"選擇的品項",-1)),e(Z,{data:_.value,size:"small","max-height":"300"},{default:t(()=>[e(f,{prop:"item_name",label:"品名"}),e(f,{prop:"purchase_order_number",label:"採購單號",width:"120"}),e(f,{prop:"supplier_name",label:"供應商",width:"150"}),e(f,{label:"物流狀態",width:"100"},{default:t(({row:a})=>[e(k,{type:T(a.delivery_status),size:"small"},{default:t(()=>[n(i(a.delivery_status),1)]),_:2},1032,["type"])]),_:1}),e(f,{label:"數量",width:"100"},{default:t(({row:a})=>[n(i(a.quantity)+" "+i(a.unit),1)]),_:1})]),_:1},8,["data"])]),e(X,{model:h,"label-width":"120px"},{default:t(()=>[e(w,{label:"收貨人員"},{default:t(()=>[e(V,{modelValue:h.receiver,"onUpdate:modelValue":l[10]||(l[10]=a=>h.receiver=a),value:A.value,disabled:""},null,8,["modelValue","value"])]),_:1}),e(w,{label:"收貨時間"},{default:t(()=>[e(pe,{modelValue:h.received_time,"onUpdate:modelValue":l[11]||(l[11]=a=>h.received_time=a),type:"datetime",placeholder:"選擇收貨時間",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(w,{label:"批量備註"},{default:t(()=>[e(V,{modelValue:h.notes,"onUpdate:modelValue":l[12]||(l[12]=a=>h.notes=a),type:"textarea",rows:"3",placeholder:"請記錄收貨狀況和備註..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),e(ee,{modelValue:L.value,"onUpdate:modelValue":l[17]||(l[17]=a=>L.value=a),title:`收貨詳情 - ${((be=r.value)==null?void 0:be.purchase_order_number)||""}`,width:"800px"},{footer:t(()=>[e(v,{onClick:l[15]||(l[15]=a=>L.value=!1)},{default:t(()=>[...l[47]||(l[47]=[n("關閉",-1)])]),_:1}),e(v,{type:"primary",onClick:l[16]||(l[16]=a=>K(r.value))},{default:t(()=>[...l[48]||(l[48]=[n("立即收貨",-1)])]),_:1})]),default:t(()=>[r.value?(c(),b("div",El,[e(P,{column:2,border:""},{default:t(()=>[e(u,{label:"品項名稱"},{default:t(()=>[n(i(r.value.item_name),1)]),_:1}),e(u,{label:"規格"},{default:t(()=>[n(i(r.value.specification||"-"),1)]),_:1}),e(u,{label:"數量"},{default:t(()=>[n(i(r.value.quantity)+" "+i(r.value.unit),1)]),_:1}),e(u,{label:"請購單號"},{default:t(()=>[n(i(r.value.requisition_number),1)]),_:1}),e(u,{label:"採購單號"},{default:t(()=>[n(i(r.value.purchase_order_number),1)]),_:1}),e(u,{label:"集運單號"},{default:t(()=>[n(i(r.value.consolidation_number||"-"),1)]),_:1}),e(u,{label:"供應商"},{default:t(()=>[n(i(r.value.supplier_name),1)]),_:1}),e(u,{label:"供應商地區"},{default:t(()=>[e(k,{type:r.value.supplier_region==="domestic"?"success":"warning",size:"small"},{default:t(()=>[n(i(r.value.supplier_region==="domestic"?"國內供應商":"國外供應商"),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"物流狀態"},{default:t(()=>[e(k,{type:T(r.value.delivery_status),size:"small"},{default:t(()=>[n(i(r.value.delivery_status),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"預計到貨日"},{default:t(()=>[n(i(r.value.expected_delivery_date?J(r.value.expected_delivery_date):"-"),1)]),_:1}),e(u,{label:"延期狀況"},{default:t(()=>[S(r.value.expected_delivery_date)>0?(c(),b("span",zl," 延期 "+i(S(r.value.expected_delivery_date))+" 天 ",1)):(c(),b("span",Il,"準時"))]),_:1}),e(u,{label:"備註",span:2},{default:t(()=>[n(i(r.value.remarks||"-"),1)]),_:1})]),_:1}),r.value.receipt_history&&r.value.receipt_history.length>0?(c(),b("div",Sl,[l[46]||(l[46]=s("h4",null,"收貨記錄",-1)),e(Z,{data:r.value.receipt_history,size:"small"},{default:t(()=>[e(f,{prop:"received_date",label:"收貨日期",width:"120"},{default:t(({row:a})=>[n(i(J(a.received_date)),1)]),_:1}),e(f,{prop:"quantity",label:"收貨數量",width:"100"}),e(f,{prop:"location",label:"收貨地點",width:"120"}),e(f,{prop:"quality_status",label:"品質狀況",width:"100"},{default:t(({row:a})=>[e(k,{type:Fe(a.quality_status),size:"small"},{default:t(()=>[n(i(Te(a.quality_status)),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"received_by",label:"收貨人",width:"100"}),e(f,{prop:"notes",label:"備註"})]),_:1},8,["data"])])):E("",!0)])):E("",!0)]),_:1},8,["modelValue","title"])])}}});const Jl=yt(ql,[["__scopeId","data-v-1c45abc8"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/inventory/Receiving.vue"]]);export{Jl as default};
//# sourceMappingURL=Receiving-b05b1e72.js.map
