import{d as ne,n as ie,y as _e,r as z,a as re,a1 as de,X as v,c as g,b as _,e,w as a,bq as H,al as ue,o as p,t as s,ab as M,g as y,ap as j,i,aZ as ce,aP as $,q as T,b7 as K,b8 as pe,ay as me,I as fe,m as ve,aj as ge,a4 as ye,aJ as be,ao as he,aK as ke,a$ as we,av as Ce,aQ as De,aw as Ee,ax as ze,b0 as Te,aS as Ie,_ as qe}from"./index-61294aba.js";/* empty css                   *//* empty css                    *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                  */const xe={class:"inventory-item-details"},Pe={class:"header-section"},Ve={class:"header-content"},$e={class:"item-info"},Ae={class:"item-name"},Be={key:0,class:"item-spec"},Se={class:"actions"},Le={class:"summary-cards"},Re={class:"summary-card"},He={class:"summary-value"},Me={class:"summary-unit"},je={class:"summary-card"},Ke={class:"summary-value"},Ne={class:"summary-card"},Oe={class:"summary-value"},Ue={class:"summary-card"},We={class:"summary-value"},Qe={class:"details-section"},Fe={class:"basic-info"},Ge={class:"batches-info"},Je={class:"storage-info"},Xe={class:"history-info"},Ze={class:"history-controls"},Ye={key:0},et={key:1},tt={key:2},at={key:3},ot={key:1},st={key:0,class:"pagination-wrapper"},lt=ne({__name:"ItemDetails",setup(nt){const N=ie(),A=_e(),w=z(!1),D=z(!1),I=z("basic"),r=z(null),m=re({movements:[],pagination:null}),q=N.params.itemKey,B=async()=>{try{w.value=!0;const{inventoryApi:n}=await H(()=>import("./index-61294aba.js").then(c=>c.bA),["assets/index-61294aba.js","assets/index-d030048c.css"]),l=await n.getInventoryItemDetails(q);r.value=l}catch(n){console.error("Error loading item details:",n),v.error("載入物料詳情失敗")}finally{w.value=!1}},C=async(n=1,l=20)=>{try{D.value=!0;const{inventoryApi:c}=await H(()=>import("./index-61294aba.js").then(b=>b.bA),["assets/index-61294aba.js","assets/index-d030048c.css"]),f=await c.getInventoryItemHistory(q,n,l);m.movements=f.movements,m.pagination=f.pagination}catch(c){console.error("Error loading item history:",c),v.error("載入異動履歷失敗")}finally{D.value=!1}},O=()=>{B(),I.value==="history"&&C()},U=()=>{A.back()},W=n=>{n==="history"&&m.movements.length===0&&C()},Q=n=>{var l;C(n,((l=m.pagination)==null?void 0:l.per_page)||20)},F=n=>{C(1,n)},S=n=>n?new Date(n).toLocaleDateString("zh-TW"):"-",G=n=>n?new Date(n).toLocaleString("zh-TW"):"-",x=n=>!n||n<=0?"danger":n<=10?"warning":"success",J=n=>({receiving:"收貨入庫",issue:"領用出庫",transfer:"庫位轉移",adjustment:"盤點調整"})[n]||n,X=n=>{v.info(`檢視採購單: ${n}`)},Z=n=>{v.info(`檢視批次詳情: ${n}`)},Y=n=>{v.info(`檢視批次履歷: ${n}`)},ee=n=>{v.info(`檢視儲存位置: ${n}`)},te=()=>{v.info("匯出履歷功能開發中")};return de(()=>{if(!q){v.error("無效的物料識別碼"),A.back();return}B()}),(n,l)=>{const c=fe,f=ve,b=ge,ae=ye,L=ue,h=be,k=he,oe=ke,E=we,d=Ce,R=De,P=Ee,se=ze,le=Te,V=Ie;return p(),g("div",xe,[_("div",Pe,[e(L,null,{header:a(()=>{var t,o;return[_("div",Ve,[_("div",$e,[_("h2",Ae,s((t=r.value)==null?void 0:t.item_name),1),(o=r.value)!=null&&o.item_specification?(p(),g("p",Be,s(r.value.item_specification),1)):M("",!0)]),_("div",Se,[e(f,{onClick:O,loading:w.value},{default:a(()=>[e(c,null,{default:a(()=>[e(y(j))]),_:1}),l[3]||(l[3]=i(" 重新整理 ",-1))]),_:1},8,["loading"]),e(f,{onClick:U},{default:a(()=>[e(c,null,{default:a(()=>[e(y(ce))]),_:1}),l[4]||(l[4]=i(" 返回 ",-1))]),_:1})])])]}),default:a(()=>[_("div",Le,[e(ae,{gutter:20},{default:a(()=>[e(b,{span:6},{default:a(()=>{var t,o;return[_("div",Re,[_("div",He,s(((t=r.value)==null?void 0:t.total_quantity)||0),1),l[5]||(l[5]=_("div",{class:"summary-label"},"總庫存數量",-1)),_("div",Me,s((o=r.value)==null?void 0:o.unit),1)])]}),_:1}),e(b,{span:6},{default:a(()=>{var t;return[_("div",je,[_("div",Ke,s(((t=r.value)==null?void 0:t.batch_count)||0),1),l[6]||(l[6]=_("div",{class:"summary-label"},"批次數量",-1))])]}),_:1}),e(b,{span:6},{default:a(()=>{var t,o;return[_("div",Ne,[_("div",Oe,s(((o=(t=r.value)==null?void 0:t.storage_distribution)==null?void 0:o.length)||0),1),l[7]||(l[7]=_("div",{class:"summary-label"},"儲存位置",-1))])]}),_:1}),e(b,{span:6},{default:a(()=>{var t,o,u;return[_("div",Ue,[_("div",We,s(S((u=(o=(t=r.value)==null?void 0:t.batches)==null?void 0:o[0])==null?void 0:u.received_date)||"-"),1),l[8]||(l[8]=_("div",{class:"summary-label"},"最近收貨日期",-1))])]}),_:1})]),_:1})])]),_:1})]),_("div",Qe,[e(L,null,{default:a(()=>[e(le,{modelValue:I.value,"onUpdate:modelValue":l[2]||(l[2]=t=>I.value=t),onTabChange:W},{default:a(()=>[e(E,{label:"基本資訊",name:"basic"},{default:a(()=>[_("div",Fe,[e(oe,{column:2,border:""},{default:a(()=>[e(h,{label:"物料名稱"},{default:a(()=>{var t;return[i(s((t=r.value)==null?void 0:t.item_name),1)]}),_:1}),e(h,{label:"規格說明"},{default:a(()=>{var t;return[i(s(((t=r.value)==null?void 0:t.item_specification)||"-"),1)]}),_:1}),e(h,{label:"單位"},{default:a(()=>{var t;return[i(s((t=r.value)==null?void 0:t.unit),1)]}),_:1}),e(h,{label:"總庫存數量"},{default:a(()=>{var t;return[e(k,{type:x((t=r.value)==null?void 0:t.total_quantity)},{default:a(()=>{var o,u;return[i(s((o=r.value)==null?void 0:o.total_quantity)+" "+s((u=r.value)==null?void 0:u.unit),1)]}),_:1},8,["type"])]}),_:1}),e(h,{label:"批次總數"},{default:a(()=>{var t;return[i(s((t=r.value)==null?void 0:t.batch_count),1)]}),_:1}),e(h,{label:"儲存位置總數"},{default:a(()=>{var t,o;return[i(s(((o=(t=r.value)==null?void 0:t.storage_distribution)==null?void 0:o.length)||0),1)]}),_:1})]),_:1})])]),_:1}),e(E,{label:"批次分佈",name:"batches"},{default:a(()=>{var t;return[_("div",Ge,[$((p(),T(P,{data:(t=r.value)==null?void 0:t.batches,stripe:""},{default:a(()=>[e(d,{prop:"batch_id",label:"批次ID",width:"100"}),e(d,{prop:"source_po_number",label:"來源採購單",width:"150"},{default:a(({row:o})=>[e(R,{type:"primary",onClick:u=>X(o.source_po_number)},{default:a(()=>[i(s(o.source_po_number),1)]),_:2},1032,["onClick"])]),_:1}),e(d,{prop:"current_quantity",label:"目前數量",width:"120",align:"right"},{default:a(({row:o})=>[e(k,{type:x(o.current_quantity),size:"small"},{default:a(()=>[i(s(o.current_quantity),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"original_quantity",label:"原始數量",width:"120",align:"right"},{default:a(({row:o})=>[i(s(o.original_quantity),1)]),_:1}),e(d,{prop:"received_date",label:"收貨日期",width:"120"},{default:a(({row:o})=>[i(s(S(o.received_date)),1)]),_:1}),e(d,{prop:"receiver_name",label:"收貨人",width:"100"},{default:a(({row:o})=>[i(s(o.receiver_name),1)]),_:1}),e(d,{prop:"batch_status",label:"狀態",width:"100"},{default:a(({row:o})=>[e(k,{type:o.batch_status==="active"?"success":"info",size:"small"},{default:a(()=>[i(s(o.batch_status==="active"?"正常":"已耗盡"),1)]),_:2},1032,["type"])]),_:1}),e(d,{label:"操作",width:"150"},{default:a(({row:o})=>[e(f,{size:"small",onClick:u=>Z(o.batch_id)},{default:a(()=>[e(c,null,{default:a(()=>[e(y(K))]),_:1}),l[9]||(l[9]=i(" 詳情 ",-1))]),_:1},8,["onClick"]),e(f,{size:"small",onClick:u=>Y(o.batch_id)},{default:a(()=>[e(c,null,{default:a(()=>[e(y(pe))]),_:1}),l[10]||(l[10]=i(" 履歷 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[V,w.value]])])]}),_:1}),e(E,{label:"儲存分佈",name:"storage"},{default:a(()=>{var t;return[_("div",Je,[$((p(),T(P,{data:(t=r.value)==null?void 0:t.storage_distribution,stripe:""},{default:a(()=>[e(d,{prop:"storage_id",label:"儲存位置",width:"200"},{default:a(({row:o})=>[e(k,{type:"info",size:"small"},{default:a(()=>[i(s(o.storage_id),1)]),_:2},1024)]),_:1}),e(d,{label:"位置描述",width:"200"},{default:a(({row:o})=>[i(s(o.area_code)+"-"+s(o.shelf_code)+"-第"+s(o.floor_level)+"層 ",1)]),_:1}),e(d,{prop:"quantity",label:"數量",width:"120",align:"right"},{default:a(({row:o})=>[e(k,{type:x(o.quantity),size:"small"},{default:a(()=>{var u;return[i(s(o.quantity)+" "+s((u=r.value)==null?void 0:u.unit),1)]}),_:2},1032,["type"])]),_:1}),e(d,{label:"佔比",width:"120",align:"right"},{default:a(({row:o})=>{var u;return[i(s((o.quantity/((u=r.value)==null?void 0:u.total_quantity)*100).toFixed(1))+"% ",1)]}),_:1}),e(d,{label:"操作",width:"150"},{default:a(({row:o})=>[e(f,{size:"small",onClick:u=>ee(o.storage_id)},{default:a(()=>[e(c,null,{default:a(()=>[e(y(K))]),_:1}),l[11]||(l[11]=i(" 查看 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[V,w.value]])])]}),_:1}),e(E,{label:"異動履歷",name:"history"},{default:a(()=>[_("div",Xe,[_("div",Ze,[e(f,{onClick:C,loading:D.value},{default:a(()=>[e(c,null,{default:a(()=>[e(y(j))]),_:1}),l[12]||(l[12]=i(" 重新載入 ",-1))]),_:1},8,["loading"]),e(f,{onClick:te},{default:a(()=>[e(c,null,{default:a(()=>[e(y(me))]),_:1}),l[13]||(l[13]=i(" 匯出履歷 ",-1))]),_:1})]),$((p(),T(P,{data:m.movements,stripe:""},{default:a(()=>[e(d,{prop:"movement_date",label:"異動時間",width:"160"},{default:a(({row:t})=>[i(s(G(t.movement_date)),1)]),_:1}),e(d,{prop:"movement_type",label:"異動類型",width:"100"},{default:a(({row:t})=>[e(k,{type:t.movement_type==="in"?"success":"warning",size:"small"},{default:a(()=>[i(s(t.movement_type==="in"?"入庫":"出庫"),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"movement_subtype",label:"異動子類型",width:"120"},{default:a(({row:t})=>[i(s(J(t.movement_subtype)),1)]),_:1}),e(d,{prop:"quantity",label:"數量",width:"100",align:"right"},{default:a(({row:t})=>[i(s(t.quantity),1)]),_:1}),e(d,{label:"儲存位置",width:"200"},{default:a(({row:t})=>[t.from_storage_id&&t.to_storage_id?(p(),g("div",Ye,s(t.from_storage_id)+" → "+s(t.to_storage_id),1)):t.to_storage_id?(p(),g("div",et," 入庫至 "+s(t.to_storage_id),1)):t.from_storage_id?(p(),g("div",tt," 從 "+s(t.from_storage_id)+" 出庫 ",1)):(p(),g("div",at,"-"))]),_:1}),e(d,{prop:"operator.chinese_name",label:"操作人員",width:"100"}),e(d,{prop:"reference_number",label:"參考單號",width:"150"},{default:a(({row:t})=>[t.reference_number?(p(),T(R,{key:0,type:"primary"},{default:a(()=>[i(s(t.reference_number),1)]),_:2},1024)):(p(),g("span",ot,"-"))]),_:1}),e(d,{prop:"notes",label:"備註","min-width":"200"},{default:a(({row:t})=>[i(s(t.notes||"-"),1)]),_:1})]),_:1},8,["data"])),[[V,D.value]]),m.pagination?(p(),g("div",st,[e(se,{"current-page":m.pagination.page,"onUpdate:currentPage":l[0]||(l[0]=t=>m.pagination.page=t),"page-size":m.pagination.per_page,"onUpdate:pageSize":l[1]||(l[1]=t=>m.pagination.per_page=t),"page-sizes":[10,20,50,100],total:m.pagination.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:Q},null,8,["current-page","page-size","total"])])):M("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])}}});const wt=qe(lt,[["__scopeId","data-v-8ff06758"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/inventory/ItemDetails.vue"]]);export{wt as default};
//# sourceMappingURL=ItemDetails-1a2747e3.js.map
