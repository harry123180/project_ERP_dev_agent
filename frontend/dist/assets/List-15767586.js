import{d as K,y as W,r as m,a as O,a1 as q,c as g,b as f,e as a,w as o,aA as G,X as Q,m as X,E as H,al as J,o as p,i as s,f as Y,aP as Z,q as z,t as u,ah as ee,ai as te,k as ae,j as oe,av as le,aQ as ne,ao as se,b5 as re,aw as ie,ax as pe,aS as ue,_ as de}from"./index-61294aba.js";/* empty css                   *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                    *//* empty css                *//* empty css                     *//* empty css                  */const ce={class:"projects-list"},_e={class:"page-header"},me={class:"filter-section"},ge={key:0},fe={key:1},we={key:1},he={class:"pagination-wrapper"},ve=K({__name:"List",setup(be){const w=W(),h=m(!1),y=m([]),d=m(1),v=m(20),j=m(0),r=O({status:"",search:""}),c=async()=>{var l;h.value=!0;try{const t=await G.getProjects({page:d.value,page_size:v.value,status:r.status,search:r.search}),n=t.data||t;y.value=n.data||n.items||[],j.value=((l=n.pagination)==null?void 0:l.total)||n.total||0}catch(t){console.error("Failed to fetch projects:",t),Q.error("載入專案列表失敗")}finally{h.value=!1}},k=()=>{d.value=1,c()},P=()=>{r.status="",r.search="",d.value=1,c()},S=()=>{w.push("/projects/create")},E=l=>{w.push(`/projects/${l.project_id}`)},V=l=>{w.push(`/projects/${l.project_id}/edit`)},C=l=>l.toLocaleString("zh-TW"),L=l=>l?new Date(l).toLocaleDateString("zh-TW"):"-",T=l=>{const t=(l.total_expenditure||0)/l.budget*100;return t>=90?"exception":t>=70?"warning":"success"};return q(()=>{c()}),(l,t)=>{const n=X,x=ee,D=te,b=ae,$=oe,A=H,i=le,B=ne,N=se,R=re,M=ie,U=pe,F=J,I=ue;return p(),g("div",ce,[f("div",_e,[t[5]||(t[5]=f("h1",null,"專案管理",-1)),a(n,{type:"primary",icon:"Plus",onClick:S},{default:o(()=>[...t[4]||(t[4]=[s("新增專案",-1)])]),_:1})]),f("div",me,[a(A,{inline:!0,model:r,class:"filter-form"},{default:o(()=>[a(b,{label:"專案狀態"},{default:o(()=>[a(D,{modelValue:r.status,"onUpdate:modelValue":t[0]||(t[0]=e=>r.status=e),placeholder:"全部狀態",clearable:"",style:{width:"150px"}},{default:o(()=>[a(x,{label:"進行中",value:"ongoing"}),a(x,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),a(b,{label:"搜尋"},{default:o(()=>[a($,{modelValue:r.search,"onUpdate:modelValue":t[1]||(t[1]=e=>r.search=e),placeholder:"專案名稱/客戶名稱",clearable:"",style:{width:"250px"},onKeyup:Y(k,["enter"])},null,8,["modelValue"])]),_:1}),a(b,null,{default:o(()=>[a(n,{type:"primary",icon:"Search",onClick:k},{default:o(()=>[...t[6]||(t[6]=[s("查詢",-1)])]),_:1}),a(n,{icon:"Refresh",onClick:P},{default:o(()=>[...t[7]||(t[7]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),a(F,null,{default:o(()=>[Z((p(),z(M,{data:y.value,stripe:""},{default:o(()=>[a(i,{prop:"project_code",label:"專案代碼",width:"120"}),a(i,{prop:"project_name",label:"專案名稱","min-width":"200"},{default:o(e=>[a(B,{type:"primary",onClick:_=>E(e.row)},{default:o(()=>[s(u(e.row.project_name),1)]),_:2},1032,["onClick"])]),_:1}),a(i,{prop:"project_status",label:"狀態",width:"100"},{default:o(e=>[a(N,{type:e.row.project_status==="ongoing"?"success":"info"},{default:o(()=>[s(u(e.row.project_status==="ongoing"?"進行中":"已完成"),1)]),_:2},1032,["type"])]),_:1}),a(i,{prop:"budget",label:"預算",width:"150",align:"right"},{default:o(e=>[e.row.budget?(p(),g("span",ge,"NT$ "+u(C(e.row.budget)),1)):(p(),g("span",fe,"-"))]),_:1}),a(i,{prop:"total_expenditure",label:"已花費",width:"150",align:"right"},{default:o(e=>[s(" NT$ "+u(C(e.row.total_expenditure||0)),1)]),_:1}),a(i,{label:"預算使用率",width:"150"},{default:o(e=>[e.row.budget&&e.row.budget>0?(p(),z(R,{key:0,percentage:Math.min(100,Math.round((e.row.total_expenditure||0)/e.row.budget*100)),status:T(e.row)},null,8,["percentage","status"])):(p(),g("span",we,"-"))]),_:1}),a(i,{prop:"start_date",label:"開始日期",width:"120"},{default:o(e=>[s(u(L(e.row.start_date)),1)]),_:1}),a(i,{prop:"manager",label:"負責人",width:"100"},{default:o(e=>{var _;return[s(u(((_=e.row.manager)==null?void 0:_.chinese_name)||"-"),1)]}),_:1}),a(i,{label:"操作",width:"150",fixed:"right"},{default:o(e=>[a(n,{size:"small",type:"primary",onClick:_=>E(e.row)},{default:o(()=>[...t[8]||(t[8]=[s("查看",-1)])]),_:1},8,["onClick"]),a(n,{size:"small",onClick:_=>V(e.row)},{default:o(()=>[...t[9]||(t[9]=[s("編輯",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[I,h.value]]),f("div",he,[a(U,{"current-page":d.value,"onUpdate:currentPage":t[2]||(t[2]=e=>d.value=e),"page-size":v.value,"onUpdate:pageSize":t[3]||(t[3]=e=>v.value=e),"page-sizes":[10,20,50,100],total:j.value,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])])]),_:1})])}}});const Ae=de(ve,[["__scopeId","data-v-528d6f47"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/projects/List.vue"]]);export{Ae as default};
//# sourceMappingURL=List-15767586.js.map
