import{d as R,n as k,y as I,r as h,p as A,a as B,a1 as N,c as S,b as w,t as y,e,w as o,aA as _,X as c,al as q,o as O,i as V,j as G,k as K,aj as T,a4 as W,ah as X,ai as z,aF as H,au as J,b6 as L,m as Q,E as Z,_ as $}from"./index-61294aba.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                   *//* empty css                             *//* empty css                 *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                  *//* empty css               */const ee={class:"project-form"},te={class:"page-header"},oe=R({__name:"Form",setup(ae){const i=k(),f=I(),g=h(),u=h(!1),p=A(()=>!!i.params.id),a=B({project_code:"",project_name:"",description:"",project_status:"ongoing",budget:null,start_date:"",end_date:"",customer_name:"",customer_department:"",customer_contact:"",customer_phone:"",customer_address:""}),E={project_name:[{required:!0,message:"請輸入專案名稱",trigger:"blur"},{min:2,max:200,message:"專案名稱長度在 2 到 200 個字符",trigger:"blur"}],project_status:[{required:!0,message:"請選擇專案狀態",trigger:"change"}],start_date:[{required:!0,message:"請選擇開始日期",trigger:"change"}],end_date:[{validator:(s,t,r)=>{t&&a.start_date&&new Date(t)<new Date(a.start_date)?r(new Error("結束日期不能早於開始日期")):r()},trigger:"change"}],budget:[{type:"number",min:0,message:"預算必須大於等於0",trigger:"blur"}]},x=async()=>{if(p.value){u.value=!0;try{const s=i.params.id,t=await _.getProject(s);Object.keys(a).forEach(r=>{t[r]!==void 0&&(a[r]=t[r])})}catch(s){console.error("Failed to load project:",s),c.error("載入專案資料失敗"),f.push("/projects")}finally{u.value=!1}}},Y=async()=>{g.value&&await g.value.validate(async s=>{if(s){u.value=!0;try{const t={...a};p.value?(await _.updateProject(i.params.id,t),c.success("專案更新成功")):(t.project_id=await _.generateProjectId(),t.manager_id=1,await _.createProject(t),c.success("專案建立成功")),f.push("/projects")}catch(t){console.error("Failed to save project:",t),c.error(p.value?"更新專案失敗":"建立專案失敗")}finally{u.value=!1}}})},D=()=>{f.push("/projects")};return N(()=>{x()}),(s,t)=>{const r=G,d=K,n=T,m=W,b=X,U=z,M=H,j=J,F=L,v=Q,C=Z,P=q;return O(),S("div",ee,[w("div",te,[w("h1",null,y(p.value?"編輯專案":"新增專案"),1)]),e(P,null,{default:o(()=>[e(C,{ref_key:"formRef",ref:g,model:a,rules:E,"label-width":"120px",disabled:u.value},{default:o(()=>[e(m,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(d,{label:"專案代碼",prop:"project_code"},{default:o(()=>[e(r,{modelValue:a.project_code,"onUpdate:modelValue":t[0]||(t[0]=l=>a.project_code=l),placeholder:"請輸入專案代碼（選填）",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(d,{label:"專案名稱",prop:"project_name"},{default:o(()=>[e(r,{modelValue:a.project_name,"onUpdate:modelValue":t[1]||(t[1]=l=>a.project_name=l),placeholder:"請輸入專案名稱",maxlength:"200"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{label:"專案描述",prop:"description"},{default:o(()=>[e(r,{modelValue:a.description,"onUpdate:modelValue":t[2]||(t[2]=l=>a.description=l),type:"textarea",rows:3,placeholder:"請輸入專案描述",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(d,{label:"專案狀態",prop:"project_status"},{default:o(()=>[e(U,{modelValue:a.project_status,"onUpdate:modelValue":t[3]||(t[3]=l=>a.project_status=l),placeholder:"請選擇專案狀態"},{default:o(()=>[e(b,{label:"進行中",value:"ongoing"}),e(b,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(d,{label:"專案預算",prop:"budget"},{default:o(()=>[e(M,{modelValue:a.budget,"onUpdate:modelValue":t[4]||(t[4]=l=>a.budget=l),min:0,precision:0,"controls-position":"right",placeholder:"請輸入專案預算",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(m,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(d,{label:"開始日期",prop:"start_date"},{default:o(()=>[e(j,{modelValue:a.start_date,"onUpdate:modelValue":t[5]||(t[5]=l=>a.start_date=l),type:"date",placeholder:"選擇開始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(d,{label:"結束日期",prop:"end_date"},{default:o(()=>[e(j,{modelValue:a.end_date,"onUpdate:modelValue":t[6]||(t[6]=l=>a.end_date=l),type:"date",placeholder:"選擇結束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(F,{"content-position":"left"},{default:o(()=>[...t[12]||(t[12]=[V("客戶資訊",-1)])]),_:1}),e(m,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(d,{label:"客戶名稱",prop:"customer_name"},{default:o(()=>[e(r,{modelValue:a.customer_name,"onUpdate:modelValue":t[7]||(t[7]=l=>a.customer_name=l),placeholder:"請輸入客戶名稱",maxlength:"200"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(d,{label:"客戶部門",prop:"customer_department"},{default:o(()=>[e(r,{modelValue:a.customer_department,"onUpdate:modelValue":t[8]||(t[8]=l=>a.customer_department=l),placeholder:"請輸入客戶部門",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(m,{gutter:20},{default:o(()=>[e(n,{span:12},{default:o(()=>[e(d,{label:"聯絡人",prop:"customer_contact"},{default:o(()=>[e(r,{modelValue:a.customer_contact,"onUpdate:modelValue":t[9]||(t[9]=l=>a.customer_contact=l),placeholder:"請輸入聯絡人姓名",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(d,{label:"聯絡電話",prop:"customer_phone"},{default:o(()=>[e(r,{modelValue:a.customer_phone,"onUpdate:modelValue":t[10]||(t[10]=l=>a.customer_phone=l),placeholder:"請輸入聯絡電話",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{label:"客戶地址",prop:"customer_address"},{default:o(()=>[e(r,{modelValue:a.customer_address,"onUpdate:modelValue":t[11]||(t[11]=l=>a.customer_address=l),placeholder:"請輸入客戶地址",maxlength:"500"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(v,{type:"primary",onClick:Y,loading:u.value},{default:o(()=>[V(y(p.value?"更新":"建立"),1)]),_:1},8,["loading"]),e(v,{onClick:D},{default:o(()=>[...t[13]||(t[13]=[V("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model","disabled"])]),_:1})])}}});const ge=$(oe,[["__scopeId","data-v-51b9ec12"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/projects/Form.vue"]]);export{ge as default};
//# sourceMappingURL=Form-fc1a2a95.js.map
