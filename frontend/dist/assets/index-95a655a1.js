import{d as H,n as K,p as C,o as u,q as p,w as e,c as M,s as $,i as c,t as b,F as B,v as re,x as de,_ as N,y as ue,u as ie,r as w,z as U,A as ce,B as me,e as t,b as v,C as j,g as G,D as _e,G as pe,H as fe,I as we,J as ve,K as ge,L as he,M as be,m as xe,N as Ee,O as Pe,P as ye,Q as Re,R as Ve,S as ke,j as Ce,k as Me,E as Be,T as Ae}from"./index-61294aba.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                     *//* empty css                         */import"./el-tooltip-4ed993c7.js";/* empty css                       *//* empty css                           */const Ie=H({__name:"Breadcrumb",setup(O){const x=K(),E=C(()=>{const l=[];l.push({text:"首頁",to:"/dashboard"});const m=x.matched.filter(n=>n.meta&&n.meta.title);if(m.forEach((n,g)=>{var V;if(n.path==="/")return;const h=g===m.length-1,f=(V=n.meta)==null?void 0:V.title;f&&l.push({text:f,to:h?void 0:n.path})}),x.params.id){const n=x.name;n!=null&&n.includes("Edit")?l[l.length-1].text="編輯":n!=null&&n.includes("Detail")&&(l[l.length-1].text="詳情")}return l});return(l,m)=>{const n=re,g=de;return u(),p(g,{class:"breadcrumb",separator:"/"},{default:e(()=>[(u(!0),M(B,null,$(E.value,(h,f)=>(u(),p(n,{key:f,to:h.to||void 0},{default:e(()=>[c(b(h.text),1)]),_:2},1032,["to"]))),128))]),_:1})}}});const De=N(Ie,[["__scopeId","data-v-cf5e6d82"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/layout/components/Breadcrumb.vue"]]),qe={class:"header-left"},Fe={class:"header-right"},Se={class:"user-dropdown"},$e={class:"user-name"},Le=H({__name:"index",setup(O){const x=K(),E=ue(),l=ie(),m=w(!1),n=C(()=>m.value?"64px":"200px"),g=C(()=>l.userName),h=w(""),f=w(""),V=C(()=>{var a;return(((a=E.getRoutes().find(s=>s.path==="/"))==null?void 0:a.children)||[]).filter(s=>{var _;if(!((_=s.meta)!=null&&_.title)||s.meta.hideInMenu)return!1;if(s.meta.requiresRole){const y=Array.isArray(s.meta.requiresRole)?s.meta.requiresRole:[s.meta.requiresRole];return l.hasRole(...y)}return!0}).map(s=>{var _;return{...s,children:(_=s.children)==null?void 0:_.filter(y=>{var k;return!((k=y.meta)!=null&&k.hideInMenu)})}})}),P=w(!1),A=w(!1),I=w(),i=w({currentPassword:"",newPassword:"",confirmPassword:""}),W={currentPassword:[{required:!0,message:"請輸入當前密碼",trigger:"blur"}],newPassword:[{required:!0,message:"請輸入新密碼",trigger:"blur"},{min:6,message:"密碼長度至少6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"請確認新密碼",trigger:"blur"},{validator:(d,a,s)=>{a!==i.value.newPassword?s(new Error("兩次輸入的密碼不一致")):s()},trigger:"blur"}]},z=()=>{m.value=!m.value},J=d=>{switch(d){case"profile":E.push("/profile");break;case"password":E.push("/profile");break;case"logout":Q();break}},Q=async()=>{try{await fe.confirm("確定要登出嗎？","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}),await l.logout()}catch{}},X=async()=>{try{await I.value.validate(),A.value=!0,await l.changePassword(i.value.currentPassword,i.value.newPassword),P.value=!1,L()}catch{}finally{A.value=!1}},L=()=>{var d;i.value={currentPassword:"",newPassword:"",confirmPassword:""},(d=I.value)==null||d.clearValidate()};return U(()=>x.path,d=>{f.value=d},{immediate:!0}),U(P,d=>{d||L()}),(d,a)=>{const s=we,_=ve,y=ge,k=he,Y=be,D=xe,Z=Ee,q=Pe,ee=ye,te=Re,ae=Ve,oe=ce("router-view"),se=ke,T=me,F=Ce,S=Me,ne=Be,le=Ae;return u(),p(T,{class:"layout-container"},{default:e(()=>[t(Y,{width:n.value,class:"sidebar-container"},{default:e(()=>[a[5]||(a[5]=v("div",{class:"logo-container"},[v("h2",null,"ERP 系統")],-1)),t(k,{"default-active":f.value,collapse:m.value,"background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409eff","unique-opened":"",router:""},{default:e(()=>[(u(!0),M(B,null,$(V.value,o=>(u(),M(B,{key:o.path},[o.children&&o.children.length>1?(u(),p(y,{key:0,index:`/${o.path}`},{title:e(()=>{var r;return[t(s,null,{default:e(()=>{var R;return[(u(),p(j(((R=o.meta)==null?void 0:R.icon)||"Menu")))]}),_:2},1024),v("span",null,b((r=o.meta)==null?void 0:r.title),1)]}),default:e(()=>[(u(!0),M(B,null,$(o.children,r=>(u(),p(_,{key:r.path,index:`/${o.path}${r.path?"/"+r.path:""}`},{default:e(()=>{var R;return[c(b((R=r.meta)==null?void 0:R.title),1)]}),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(u(),p(_,{key:1,index:`/${o.path}`},{title:e(()=>{var r;return[c(b((r=o.meta)==null?void 0:r.title),1)]}),default:e(()=>[t(s,null,{default:e(()=>{var r;return[(u(),p(j(((r=o.meta)==null?void 0:r.icon)||"Menu")))]}),_:2},1024)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","collapse"])]),_:1},8,["width"]),t(T,null,{default:e(()=>[t(ae,{class:"header-container"},{default:e(()=>[v("div",qe,[t(D,{icon:G(_e),text:"",onClick:z},null,8,["icon"]),t(De)]),v("div",Fe,[t(te,{onCommand:J},{dropdown:e(()=>[t(ee,null,{default:e(()=>[t(q,{command:"profile"},{default:e(()=>[...a[6]||(a[6]=[c("個人資料",-1)])]),_:1}),t(q,{command:"password"},{default:e(()=>[...a[7]||(a[7]=[c("修改密碼",-1)])]),_:1}),t(q,{divided:"",command:"logout"},{default:e(()=>[...a[8]||(a[8]=[c("登出",-1)])]),_:1})]),_:1})]),default:e(()=>[v("span",Se,[t(Z,{size:32,src:h.value},{default:e(()=>[c(b(g.value.slice(0,1)),1)]),_:1},8,["src"]),v("span",$e,b(g.value),1),t(s,{class:"arrow-down"},{default:e(()=>[t(G(pe))]),_:1})])]),_:1})])]),_:1}),t(se,{class:"main-container"},{default:e(()=>[t(oe)]),_:1})]),_:1}),t(le,{modelValue:P.value,"onUpdate:modelValue":a[4]||(a[4]=o=>P.value=o),title:"修改密碼",width:"400px"},{footer:e(()=>[t(D,{onClick:a[3]||(a[3]=o=>P.value=!1)},{default:e(()=>[...a[9]||(a[9]=[c("取消",-1)])]),_:1}),t(D,{type:"primary",onClick:X,loading:A.value},{default:e(()=>[...a[10]||(a[10]=[c(" 確認 ",-1)])]),_:1},8,["loading"])]),default:e(()=>[t(ne,{ref_key:"passwordFormRef",ref:I,model:i.value,rules:W,"label-width":"120px"},{default:e(()=>[t(S,{label:"當前密碼",prop:"currentPassword"},{default:e(()=>[t(F,{modelValue:i.value.currentPassword,"onUpdate:modelValue":a[0]||(a[0]=o=>i.value.currentPassword=o),type:"password","show-password":"",placeholder:"請輸入當前密碼"},null,8,["modelValue"])]),_:1}),t(S,{label:"新密碼",prop:"newPassword"},{default:e(()=>[t(F,{modelValue:i.value.newPassword,"onUpdate:modelValue":a[1]||(a[1]=o=>i.value.newPassword=o),type:"password","show-password":"",placeholder:"請輸入新密碼"},null,8,["modelValue"])]),_:1}),t(S,{label:"確認新密碼",prop:"confirmPassword"},{default:e(()=>[t(F,{modelValue:i.value.confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=o=>i.value.confirmPassword=o),type:"password","show-password":"",placeholder:"請再次輸入新密碼"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}});const Xe=N(Le,[["__scopeId","data-v-051739fd"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/layout/index.vue"]]);export{Xe as default};
//# sourceMappingURL=index-95a655a1.js.map
