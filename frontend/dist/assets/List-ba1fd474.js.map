{"version":3,"file":"List-ba1fd474.js","sources":["../../src/assets/TSIC_LOGO.png","../../src/utils/download.ts","../../src/views/purchase-orders/PreviewModal.vue","../../src/views/purchase-orders/List.vue"],"sourcesContent":["export default \"__VITE_ASSET__6e33e6f9__\"","/**\r\n * 下載檔案工具函數\r\n */\r\n\r\nexport function downloadFile(blob: Blob, filename: string) {\r\n  // 方法1: 使用 FileSaver.js 的實現方式（最可靠）\r\n  if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n    // For IE\r\n    window.navigator.msSaveOrOpenBlob(blob, filename)\r\n    return\r\n  }\r\n\r\n  // 創建隱藏的 a 標籤\r\n  const link = document.createElement('a')\r\n  link.style.display = 'none'\r\n  \r\n  // 創建 blob URL\r\n  const url = window.URL.createObjectURL(blob)\r\n  link.href = url\r\n  link.download = filename\r\n  \r\n  // 設置多個屬性確保下載\r\n  link.setAttribute('download', filename)\r\n  link.setAttribute('href', url)\r\n  link.setAttribute('target', '_blank')\r\n  \r\n  // 添加到 DOM\r\n  document.body.appendChild(link)\r\n  \r\n  // 觸發點擊\r\n  const evt = new MouseEvent('click', {\r\n    view: window,\r\n    bubbles: true,\r\n    cancelable: true\r\n  })\r\n  link.dispatchEvent(evt)\r\n  \r\n  // 清理\r\n  setTimeout(() => {\r\n    document.body.removeChild(link)\r\n    window.URL.revokeObjectURL(url)\r\n  }, 100)\r\n}\r\n\r\n/**\r\n * 從後端下載檔案\r\n */\r\nexport async function downloadFromAPI(\r\n  url: string,\r\n  method: string = 'GET',\r\n  data?: any,\r\n  filename?: string,\r\n  token?: string\r\n) {\r\n  const headers: HeadersInit = {\r\n    'Content-Type': 'application/json'\r\n  }\r\n  \r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`\r\n  }\r\n  \r\n  const options: RequestInit = {\r\n    method,\r\n    headers\r\n  }\r\n  \r\n  if (data && method !== 'GET') {\r\n    options.body = JSON.stringify(data)\r\n  }\r\n  \r\n  const response = await fetch(url, options)\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Download failed: ${response.status}`)\r\n  }\r\n  \r\n  const blob = await response.blob()\r\n  \r\n  // 嘗試從 Content-Disposition header 獲取檔名\r\n  if (!filename) {\r\n    const contentDisposition = response.headers.get('content-disposition')\r\n    if (contentDisposition) {\r\n      const filenameMatch = contentDisposition.match(/filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/)\r\n      if (filenameMatch && filenameMatch[1]) {\r\n        filename = filenameMatch[1].replace(/['\"]/g, '')\r\n      }\r\n    }\r\n  }\r\n  \r\n  // 如果還是沒有檔名，根據 content-type 生成\r\n  if (!filename) {\r\n    const contentType = response.headers.get('content-type') || ''\r\n    const ext = contentType.includes('pdf') ? 'pdf' : \r\n                contentType.includes('excel') || contentType.includes('spreadsheet') ? 'xlsx' : \r\n                'bin'\r\n    filename = `download_${Date.now()}.${ext}`\r\n  }\r\n  \r\n  downloadFile(blob, filename)\r\n  \r\n  return blob\r\n}","<template>\r\n  <el-dialog\r\n    v-model=\"dialogVisible\"\r\n    title=\"採購單預覽\"\r\n    width=\"1200px\"\r\n    :before-close=\"handleClose\"\r\n    class=\"po-preview-modal\"\r\n  >\r\n    <div v-loading=\"loading\" class=\"preview-container\" :class=\"{ 'print-preview-mode': printPreviewMode }\">\r\n      <!-- Company Header with Logo -->\r\n      <div class=\"company-header\">\r\n        <div class=\"logo-section\">\r\n          <img src=\"@/assets/TSIC_LOGO.png\" alt=\"Company Logo\" class=\"company-logo\" />\r\n        </div>\r\n        <div class=\"header-center\">\r\n          <h1 class=\"title\">採購單</h1>\r\n          <h2 class=\"subtitle\">PURCHASE ORDER</h2>\r\n        </div>\r\n        <div class=\"header-right\">\r\n          <!-- Status information -->\r\n          <div class=\"status-info non-printable-section\">\r\n            <div class=\"status-badge\" :class=\"{'outputted': poData.purchase_status === 'outputted', 'order-created': poData.purchase_status === 'order_created'}\">\r\n              {{ statusDisplay }}\r\n            </div>\r\n            <div v-if=\"exportHistoryDisplay\" class=\"export-history\">\r\n              {{ exportHistoryDisplay }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Supplier and Order Info Table (4x4) -->\r\n      <div class=\"info-table-section\">\r\n        <table class=\"info-table\">\r\n          <tr>\r\n            <td class=\"label\">廠商名稱</td>\r\n            <td class=\"value\">{{ poData.supplier_name }}</td>\r\n            <td class=\"label\">採購單號</td>\r\n            <td class=\"value\">{{ poData.purchase_order_no }}</td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">廠商編號</td>\r\n            <td class=\"value\">{{ poData.supplier_id }}</td>\r\n            <td class=\"label\">訂購日期</td>\r\n            <td class=\"value\">{{ formatDate(poData.order_date) }}</td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">廠商地址</td>\r\n            <td class=\"value\">{{ poData.supplier_address || '-' }}</td>\r\n            <td class=\"label\">報價單號</td>\r\n            <td class=\"value\">\r\n              <el-input \r\n                v-model=\"poData.quotation_no\" \r\n                size=\"small\" \r\n                style=\"width: 150px\"\r\n                placeholder=\"請輸入\"\r\n                :disabled=\"isExporting\"\r\n              />\r\n            </td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">連絡電話</td>\r\n            <td class=\"value\">{{ poData.contact_phone || '-' }}</td>\r\n            <td class=\"label\">聯絡人</td>\r\n            <td class=\"value\">{{ poData.contact_person || '-' }}</td>\r\n          </tr>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Items Table -->\r\n      <div class=\"section\">\r\n        <h3 class=\"section-title\">採購明細 Purchase Items</h3>\r\n        <el-table :data=\"itemsWithIndex\" border style=\"width: 100%\">\r\n          <el-table-column prop=\"index\" label=\"項次\" width=\"60\" align=\"center\" />\r\n          <el-table-column prop=\"item_name\" label=\"品名\" min-width=\"150\" />\r\n          <el-table-column prop=\"item_specification\" label=\"規格\" min-width=\"120\">\r\n            <template #default=\"scope\">\r\n              {{ scope.row.item_specification || '-' }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"item_model\" label=\"型號\" min-width=\"100\">\r\n            <template #default=\"scope\">\r\n              {{ scope.row.item_model || '-' }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"item_quantity\" label=\"數量\" width=\"80\" align=\"right\">\r\n            <template #default=\"scope\">\r\n              {{ formatNumber(scope.row.item_quantity) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"item_unit\" label=\"單位\" width=\"60\" align=\"center\" />\r\n          <el-table-column prop=\"unit_price\" label=\"單價\" width=\"100\" align=\"right\">\r\n            <template #default=\"scope\">\r\n              <span :class=\"{ 'print-currency': printPreviewMode }\">\r\n                {{ formatCurrency(scope.row.unit_price, !printPreviewMode) }}\r\n              </span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"line_subtotal\" label=\"小計\" width=\"120\" align=\"right\">\r\n            <template #default=\"scope\">\r\n              <span :class=\"{ 'print-currency': printPreviewMode }\">\r\n                {{ formatCurrency(scope.row.line_subtotal || scope.row.item_quantity * scope.row.unit_price, !printPreviewMode) }}\r\n              </span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"備註\" min-width=\"100\">\r\n            <template #default>\r\n              -\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n\r\n      <!-- Totals -->\r\n      <div class=\"totals-section\">\r\n        <div class=\"total-row\">\r\n          <span class=\"label\">小計 Subtotal：</span>\r\n          <span class=\"value\" :class=\"{ 'print-currency': printPreviewMode }\">\r\n            {{ formatCurrency(poData.subtotal_int, !printPreviewMode) }}\r\n          </span>\r\n        </div>\r\n        <div class=\"total-row\">\r\n          <span class=\"label\">稅額 Tax (5%)：</span>\r\n          <span class=\"value\" :class=\"{ 'print-currency': printPreviewMode }\">\r\n            {{ formatCurrency(poData.tax_decimal1, !printPreviewMode) }}\r\n          </span>\r\n        </div>\r\n        <div class=\"total-row grand-total\">\r\n          <span class=\"label\">總計 Total：</span>\r\n          <span class=\"value\" :class=\"{ 'print-currency': printPreviewMode }\">\r\n            {{ formatCurrency(poData.grand_total_int, !printPreviewMode) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Terms (Note) Section with Template Selection -->\r\n      <div class=\"section terms-section\">\r\n        <h3 class=\"section-title\">注意事項 Terms and Conditions</h3>\r\n        <div class=\"terms-selector\" v-if=\"!isExporting\">\r\n          <el-select \r\n            v-model=\"selectedTermsTemplate\" \r\n            placeholder=\"選擇注意事項模板\"\r\n            size=\"small\"\r\n            style=\"width: 200px; margin-bottom: 10px\"\r\n            @change=\"loadTermsTemplate\"\r\n          >\r\n            <el-option label=\"標準條款\" value=\"standard\" />\r\n            <el-option label=\"急件條款\" value=\"urgent\" />\r\n            <el-option label=\"自訂條款\" value=\"custom\" />\r\n          </el-select>\r\n        </div>\r\n        <el-input\r\n          v-model=\"termsContent\"\r\n          type=\"textarea\"\r\n          :rows=\"8\"\r\n          placeholder=\"請輸入注意事項內容\"\r\n          :disabled=\"isExporting\"\r\n        />\r\n        <!-- Print-only terms content -->\r\n        <div class=\"terms-print-content\" style=\"display: none;\">\r\n          {{ termsContent }}\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Signature Area -->\r\n      <div class=\"signature-section\">\r\n        <div class=\"signature-row\">\r\n          <div class=\"signature-item\">\r\n            <span class=\"label\">採購人員：</span>\r\n            <span class=\"signature-line\"></span>\r\n          </div>\r\n          <div class=\"signature-item\">\r\n            <span class=\"label\">核准主管：</span>\r\n            <span class=\"signature-line\"></span>\r\n          </div>\r\n        </div>\r\n        <div class=\"signature-row\">\r\n          <div class=\"signature-item\">\r\n            <span class=\"label\">日期：</span>\r\n            <span class=\"signature-line\"></span>\r\n          </div>\r\n          <div class=\"signature-item\">\r\n            <span class=\"label\">日期：</span>\r\n            <span class=\"signature-line\"></span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Below the Print/Export Area - Not included in export -->\r\n      <div class=\"non-printable-section\" v-if=\"!printPreviewMode\">\r\n        <div class=\"divider-line\"></div>\r\n        \r\n        <!-- Delivery Information -->\r\n        <div class=\"section\">\r\n          <h3 class=\"section-title\">交貨資訊 Delivery Information</h3>\r\n          <div class=\"delivery-info\">\r\n            <div class=\"info-row\">\r\n              <span class=\"label\">交貨地址：</span>\r\n              <span class=\"value\">{{ poData.delivery_address || companyInfo.address }}</span>\r\n            </div>\r\n            <div class=\"info-row\">\r\n              <span class=\"label\">預計交貨日期：</span>\r\n              <span class=\"value\">{{ poData.expected_delivery_date || '訂單確認後 14 個工作天' }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Full Supplier Information -->\r\n        <div class=\"section supplier-section\">\r\n          <h3 class=\"section-title\">供應商詳細資訊 Supplier Details</h3>\r\n          <div class=\"supplier-info\">\r\n            <div class=\"supplier-row\">\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">廠商名稱：</span>\r\n                <span class=\"value\">{{ poData.supplier_name }}</span>\r\n              </div>\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">廠商編號：</span>\r\n                <span class=\"value\">{{ poData.supplier_id }}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"supplier-row\">\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">廠商地址：</span>\r\n                <span class=\"value\">{{ poData.supplier_address || '-' }}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"supplier-row\">\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">連絡電話：</span>\r\n                <span class=\"value\">{{ poData.contact_phone || '-' }}</span>\r\n              </div>\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">聯絡人：</span>\r\n                <span class=\"value\">{{ poData.contact_person || '-' }}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"supplier-row\">\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">統一編號：</span>\r\n                <span class=\"value\">{{ poData.supplier_tax_id || '-' }}</span>\r\n              </div>\r\n              <div class=\"info-item\">\r\n                <span class=\"label\">電子郵件：</span>\r\n                <span class=\"value\">{{ poData.supplier_email || '-' }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"handleClose\">關閉</el-button>\r\n        <el-button @click=\"togglePrintPreview\" :type=\"printPreviewMode ? 'warning' : 'info'\">\r\n          {{ printPreviewMode ? '返回編輯模式' : '列印預覽模式' }}\r\n        </el-button>\r\n        <el-button \r\n          type=\"primary\" \r\n          @click=\"handleExport('excel')\" \r\n          :loading=\"exporting\"\r\n          :disabled=\"!canExport\"\r\n          :title=\"!canExport ? `採購單狀態為「${statusDisplay}」，無法輸出` : ''\"\r\n        >\r\n          <el-icon><Download /></el-icon>\r\n          輸出 Excel\r\n        </el-button>\r\n        <el-button \r\n          type=\"primary\" \r\n          @click=\"handleExport('pdf')\" \r\n          :loading=\"exporting\"\r\n          :disabled=\"!canExport\"\r\n          :title=\"!canExport ? `採購單狀態為「${statusDisplay}」，無法輸出` : ''\"\r\n        >\r\n          <el-icon><Document /></el-icon>\r\n          輸出 PDF\r\n        </el-button>\r\n        <el-button \r\n          type=\"primary\" \r\n          @click=\"handlePrint\" \r\n          :loading=\"printing\"\r\n          :disabled=\"!canExport\"\r\n          :title=\"!canExport ? `採購單狀態為「${statusDisplay}」，無法列印` : ''\"\r\n        >\r\n          <el-icon><Printer /></el-icon>\r\n          列印\r\n        </el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, watch, computed, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Download, Document, Printer } from '@element-plus/icons-vue'\r\nimport { procurementApi } from '@/api/procurement'\r\nimport { downloadFromAPI } from '@/utils/download'\r\n\r\ninterface POPreviewData {\r\n  purchase_order_no: string\r\n  supplier_id: string\r\n  supplier_name: string\r\n  supplier_address?: string\r\n  contact_person?: string\r\n  contact_phone?: string\r\n  supplier_tax_id?: string\r\n  supplier_email?: string\r\n  order_date?: string\r\n  quotation_no?: string\r\n  delivery_address?: string\r\n  expected_delivery_date?: string\r\n  notes?: string\r\n  purchase_status?: string\r\n  last_export_at?: string\r\n  export_count?: number\r\n  subtotal_int: number\r\n  tax_decimal1: number\r\n  grand_total_int: number\r\n  items: Array<{\r\n    item_name: string\r\n    item_specification?: string\r\n    item_model?: string\r\n    item_quantity: number\r\n    item_unit: string\r\n    unit_price: number\r\n    line_subtotal?: number\r\n  }>\r\n}\r\n\r\nconst props = defineProps<{\r\n  visible: boolean\r\n  poNo: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  'update:visible': [value: boolean]\r\n  'exported': []\r\n}>()\r\n\r\nconst dialogVisible = ref(false)\r\nconst loading = ref(false)\r\nconst exporting = ref(false)\r\nconst printing = ref(false)\r\nconst isExporting = ref(false)\r\nconst poData = ref<POPreviewData>({\r\n  purchase_order_no: '',\r\n  supplier_id: '',\r\n  supplier_name: '',\r\n  subtotal_int: 0,\r\n  tax_decimal1: 0,\r\n  grand_total_int: 0,\r\n  items: []\r\n})\r\n\r\nconst companyInfo = ref({\r\n  name: 'Taiwan Semiconductor Innovation Company',\r\n  address: '台北市信義區信義路五段7號',\r\n  phone: '02-8101-2345'\r\n})\r\n\r\nconst selectedTermsTemplate = ref('standard')\r\nconst termsContent = ref(`1. 付款條件：月結 30 天\r\n2. 交貨期限：訂單確認後 14 個工作天\r\n3. 品質要求：須符合國家標準規範\r\n4. 驗收標準：貨到 7 日內完成驗收\r\n5. 保固期限：自驗收合格日起算一年`)\r\n\r\n// Add index to items for display\r\nconst itemsWithIndex = computed(() => {\r\n  return poData.value.items.map((item, index) => ({\r\n    ...item,\r\n    index: index + 1\r\n  }))\r\n})\r\n\r\n// Export eligibility computed property\r\nconst canExport = computed(() => {\r\n  return true // 根據用戶需求，所有狀態的採購單都可以輸出\r\n})\r\n\r\n// Status display computed property\r\nconst statusDisplay = computed(() => {\r\n  const statusMap: Record<string, string> = {\r\n    'pending': '待處理',\r\n    'confirmed': '已確認',\r\n    'order_created': '已建立',\r\n    'outputted': '已製單',\r\n    'purchased': '已採購',\r\n    'shipped': '已出貨'\r\n  }\r\n  return statusMap[poData.value.purchase_status || ''] || poData.value.purchase_status || '未知'\r\n})\r\n\r\n// Export history display\r\nconst exportHistoryDisplay = computed(() => {\r\n  if (!poData.value.export_count || poData.value.export_count === 0) {\r\n    return ''\r\n  }\r\n  const lastExportDate = poData.value.last_export_at \r\n    ? new Date(poData.value.last_export_at).toLocaleString('zh-TW')\r\n    : ''\r\n  return `已輸出 ${poData.value.export_count} 次${lastExportDate ? `，最後輸出：${lastExportDate}` : ''}`\r\n})\r\n\r\nwatch(() => props.visible, (newVal) => {\r\n  dialogVisible.value = newVal\r\n  if (newVal && props.poNo) {\r\n    loadPreviewData()\r\n  }\r\n})\r\n\r\nwatch(dialogVisible, (newVal) => {\r\n  emit('update:visible', newVal)\r\n})\r\n\r\nconst loadPreviewData = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await procurementApi.getPurchaseOrder(props.poNo)\r\n    const data = response\r\n    \r\n    poData.value = {\r\n      purchase_order_no: data.purchase_order_no || '',\r\n      supplier_id: data.supplier_id || '',\r\n      supplier_name: data.supplier_name || '',\r\n      supplier_address: data.supplier_address || '',\r\n      contact_person: data.contact_person || '',\r\n      contact_phone: data.contact_phone || '',\r\n      supplier_tax_id: data.supplier_tax_id || '',\r\n      supplier_email: data.supplier_email || '',\r\n      order_date: data.order_date || data.creation_date,\r\n      quotation_no: data.quotation_no || '',\r\n      delivery_address: data.delivery_address || '',\r\n      expected_delivery_date: data.expected_delivery_date || '',\r\n      notes: data.notes || '',\r\n      purchase_status: data.purchase_status || '',\r\n      last_export_at: data.last_export_at || '',\r\n      export_count: data.export_count || 0,\r\n      subtotal_int: data.subtotal_int || 0,\r\n      tax_decimal1: data.tax_decimal1 || 0,\r\n      grand_total_int: data.grand_total_int || 0,\r\n      items: data.items || []\r\n    }\r\n    \r\n    // Load default terms template\r\n    loadTermsTemplate('standard')\r\n  } catch (error) {\r\n    ElMessage.error('載入預覽資料失敗')\r\n    console.error('Failed to load preview:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst loadTermsTemplate = (templateId: string) => {\r\n  const templates: Record<string, string> = {\r\n    standard: `1. 付款條件：月結 30 天\r\n2. 交貨期限：訂單確認後 14 個工作天\r\n3. 品質要求：須符合國家標準規範\r\n4. 驗收標準：貨到 7 日內完成驗收\r\n5. 保固期限：自驗收合格日起算一年`,\r\n    urgent: `1. 付款條件：貨到付款\r\n2. 交貨期限：訂單確認後 3 個工作天內\r\n3. 品質要求：須符合國家標準規範\r\n4. 驗收標準：貨到當日完成驗收\r\n5. 保固期限：自驗收合格日起算一年\r\n6. 急件處理：需優先處理並確保準時交貨`,\r\n    custom: ''\r\n  }\r\n  \r\n  if (templates[templateId] !== undefined) {\r\n    termsContent.value = templates[templateId]\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  dialogVisible.value = false\r\n}\r\n\r\nconst handleExport = async (format: 'excel' | 'pdf') => {\r\n  exporting.value = true\r\n  isExporting.value = true\r\n  try {\r\n    // Save quotation number if edited and PO can be edited\r\n    if (poData.value.quotation_no && poData.value.purchase_status !== 'outputted') {\r\n      await procurementApi.updatePurchaseOrder(props.poNo, {\r\n        quotation_no: poData.value.quotation_no\r\n      })\r\n    }\r\n    \r\n    // Use the new download utility\r\n    const token = localStorage.getItem('auth_token')\r\n    const apiUrl = import.meta.env.VITE_API_BASE_URL || '/api/v1'\r\n    const filename = format === 'excel' \r\n      ? `PO_${props.poNo}.xlsx` \r\n      : `PO_${props.poNo}.pdf`\r\n    \r\n    // Download file using the utility function\r\n    await downloadFromAPI(\r\n      `${apiUrl}/po/${props.poNo}/export`,\r\n      'POST',\r\n      { format },\r\n      filename,\r\n      token\r\n    )\r\n    \r\n    // 移除下載成功訊息，避免列印時出現\r\n    // ElMessage.success(`採購單已成功下載為 ${format.toUpperCase()} 格式`)\r\n\r\n    // Update status after export (call status API separately)\r\n    await loadPreviewData()\r\n    \r\n    // Emit event to refresh parent list\r\n    emit('exported')\r\n    \r\n  } catch (error: any) {\r\n    if (error.response?.data?.error_code === 'EXPORT_NOT_ALLOWED') {\r\n      ElMessage.error(`無法輸出：採購單狀態為「${error.response.data.details.current_status}」`)\r\n    } else {\r\n      ElMessage.error(`輸出 ${format.toUpperCase()} 失敗`)\r\n    }\r\n    console.error('Export failed:', error)\r\n  } finally {\r\n    exporting.value = false\r\n    isExporting.value = false\r\n  }\r\n}\r\n\r\nconst printPreviewMode = ref(false)\r\n\r\nconst togglePrintPreview = () => {\r\n  printPreviewMode.value = !printPreviewMode.value\r\n}\r\n\r\nconst handlePrint = async () => {\r\n  printing.value = true\r\n  try {\r\n    // Save quotation number if edited and PO can be edited\r\n    if (poData.value.quotation_no && poData.value.purchase_status !== 'outputted') {\r\n      await procurementApi.updatePurchaseOrder(props.poNo, {\r\n        quotation_no: poData.value.quotation_no\r\n      })\r\n    }\r\n    \r\n    // Call export API for print format to handle status transitions\r\n    const response = await procurementApi.exportPurchaseOrder(props.poNo, { format: 'print' })\r\n    \r\n    if (response.export_info) {\r\n      // Update local data with new status\r\n      poData.value.purchase_status = response.export_info.current_status\r\n      poData.value.export_count = response.export_info.export_count\r\n      poData.value.last_export_at = response.export_info.export_timestamp\r\n      \r\n      // Emit event to refresh parent list\r\n      emit('exported')\r\n    }\r\n    \r\n    // Ensure terms content is properly displayed for print\r\n    const termsSection = document.querySelector('.terms-section')\r\n    const termsPrintContent = document.querySelector('.terms-print-content')\r\n    \r\n    if (termsPrintContent) {\r\n      termsPrintContent.textContent = termsContent.value\r\n      termsPrintContent.style.display = 'block'\r\n    }\r\n    \r\n    // Brief delay to ensure DOM is updated\r\n    setTimeout(() => {\r\n      window.print()\r\n\r\n      // 移除列印成功訊息，避免訊息出現在列印內容中\r\n      // setTimeout(() => {\r\n      //   if (response.export_info) {\r\n      //     if (response.export_info.previous_status !== response.export_info.current_status) {\r\n      //       ElMessage.success('採購單已準備列印，狀態已更新為「已製單」')\r\n      //     } else {\r\n      //       ElMessage.success('採購單已準備列印')\r\n      //     }\r\n      //   }\r\n      // }, 500)\r\n    }, 200)\r\n    \r\n  } catch (error: any) {\r\n    if (error.response?.data?.error_code === 'EXPORT_NOT_ALLOWED') {\r\n      ElMessage.error(`無法列印：採購單狀態為「${error.response.data.details.current_status}」`)\r\n    } else {\r\n      ElMessage.error('準備列印失敗')\r\n    }\r\n    console.error('Print preparation failed:', error)\r\n  } finally {\r\n    printing.value = false\r\n  }\r\n}\r\n\r\nconst formatDate = (date?: string) => {\r\n  if (!date) return '-'\r\n  return new Date(date).toLocaleDateString('zh-TW')\r\n}\r\n\r\nconst formatNumber = (num: number) => {\r\n  return num.toLocaleString('zh-TW')\r\n}\r\n\r\n// Import the robust formatCurrency from utils\r\nimport { formatCurrency as globalFormatCurrency } from '@/utils/format'\r\n\r\nconst formatCurrency = (amount: number | string | null | undefined, includePrefix: boolean = true) => {\r\n  // Debug log to see the actual values\r\n  console.log('formatCurrency received:', amount, typeof amount)\r\n  \r\n  if (includePrefix) {\r\n    return globalFormatCurrency(amount)\r\n  } else {\r\n    // For non-prefixed format, use global function and remove the prefix\r\n    const formatted = globalFormatCurrency(amount)\r\n    return formatted.replace('NT$ ', '')\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.po-preview-modal {\r\n  .preview-container {\r\n    padding: 20px;\r\n    background: white;\r\n    min-height: 600px;\r\n  }\r\n\r\n  .company-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    margin-bottom: 30px;\r\n    padding-bottom: 20px;\r\n    border-bottom: 2px solid #333;\r\n    \r\n    .logo-section {\r\n      flex: 0 0 150px;\r\n      \r\n      .company-logo {\r\n        max-width: 150px;\r\n        max-height: 80px;\r\n        object-fit: contain;\r\n      }\r\n    }\r\n    \r\n    .header-center {\r\n      flex: 1;\r\n      text-align: center;\r\n      \r\n      .title {\r\n        font-size: 32px;\r\n        font-weight: bold;\r\n        margin: 0;\r\n        color: #333;\r\n      }\r\n      \r\n      .subtitle {\r\n        font-size: 20px;\r\n        margin: 5px 0 0 0;\r\n        color: #666;\r\n      }\r\n    }\r\n    \r\n    .header-right {\r\n      flex: 0 0 150px;\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      align-items: center;\r\n      \r\n      .status-info {\r\n        text-align: right;\r\n        \r\n        .status-badge {\r\n          padding: 6px 12px;\r\n          border-radius: 4px;\r\n          font-size: 12px;\r\n          font-weight: 500;\r\n          margin-bottom: 4px;\r\n          \r\n          &.order-created {\r\n            background: #e6f7ff;\r\n            color: #1890ff;\r\n            border: 1px solid #91d5ff;\r\n          }\r\n          \r\n          &.outputted {\r\n            background: #f6ffed;\r\n            color: #52c41a;\r\n            border: 1px solid #b7eb8f;\r\n          }\r\n        }\r\n        \r\n        .export-history {\r\n          font-size: 10px;\r\n          color: #666;\r\n          max-width: 140px;\r\n          line-height: 1.2;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .info-table-section {\r\n    margin-bottom: 30px;\r\n    \r\n    .info-table {\r\n      width: 100%;\r\n      border-collapse: collapse;\r\n      border: 1px solid #ddd;\r\n      \r\n      tr {\r\n        border-bottom: 1px solid #ddd;\r\n        \r\n        &:last-child {\r\n          border-bottom: none;\r\n        }\r\n      }\r\n      \r\n      td {\r\n        padding: 10px;\r\n        border-right: 1px solid #ddd;\r\n        \r\n        &:last-child {\r\n          border-right: none;\r\n        }\r\n        \r\n        &.label {\r\n          background: #f5f7fa;\r\n          font-weight: 500;\r\n          color: #666;\r\n          width: 15%;\r\n          white-space: nowrap;\r\n        }\r\n        \r\n        &.value {\r\n          color: #333;\r\n          width: 35%;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .section {\r\n    margin-bottom: 25px;\r\n    \r\n    .section-title {\r\n      font-size: 16px;\r\n      font-weight: bold;\r\n      margin-bottom: 10px;\r\n      padding-bottom: 5px;\r\n      border-bottom: 2px solid #409eff;\r\n      color: #333;\r\n    }\r\n  }\r\n\r\n  .totals-section {\r\n    margin: 20px 0;\r\n    text-align: right;\r\n    padding-right: 20px;  // 減少右邊距，讓內容更靠右\r\n\r\n    .total-row {\r\n      margin-bottom: 8px;\r\n      display: flex;\r\n      justify-content: flex-end;  // 使用 flexbox 讓內容靠右對齊\r\n\r\n      .label {\r\n        font-weight: 500;\r\n        margin-right: 20px;\r\n        white-space: nowrap;  // 防止標籤換行\r\n      }\r\n\r\n      .value {\r\n        display: inline-block;\r\n        min-width: 120px;\r\n        text-align: right;\r\n        font-weight: bold;\r\n      }\r\n      \r\n      &.grand-total {\r\n        font-size: 18px;\r\n        font-weight: bold;\r\n        color: #409eff;\r\n        padding-top: 10px;\r\n        border-top: 2px solid #e4e7ed;\r\n      }\r\n    }\r\n  }\r\n\r\n  .signature-section {\r\n    margin-top: 60px;  // 增加上方間距，給注意事項更多空間\r\n    padding-top: 20px;\r\n    \r\n    .signature-row {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 30px;\r\n      \r\n      .signature-item {\r\n        display: flex;\r\n        align-items: center;\r\n        flex: 0 0 45%;\r\n        \r\n        .label {\r\n          margin-right: 10px;\r\n        }\r\n        \r\n        .signature-line {\r\n          flex: 1;\r\n          border-bottom: 1px solid #333;\r\n          height: 1px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .non-printable-section {\r\n    margin-top: 50px;\r\n    \r\n    .divider-line {\r\n      border-top: 3px dashed #ccc;\r\n      margin: 30px 0;\r\n      position: relative;\r\n      \r\n      &::after {\r\n        content: '以下區域不包含在採購單輸出中';\r\n        position: absolute;\r\n        top: -12px;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        background: white;\r\n        padding: 0 20px;\r\n        color: #999;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .delivery-info {\r\n    padding: 15px;\r\n    background: #f5f7fa;\r\n    border-radius: 4px;\r\n    \r\n    .info-row {\r\n      margin-bottom: 10px;\r\n      \r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      \r\n      .label {\r\n        font-weight: 500;\r\n        color: #666;\r\n        margin-right: 10px;\r\n      }\r\n      \r\n      .value {\r\n        color: #333;\r\n      }\r\n    }\r\n  }\r\n\r\n  .supplier-section {\r\n    .supplier-info {\r\n      background: #f5f7fa;\r\n      padding: 15px;\r\n      border-radius: 4px;\r\n      \r\n      .supplier-row {\r\n        display: flex;\r\n        margin-bottom: 10px;\r\n        \r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n        \r\n        .info-item {\r\n          flex: 1;\r\n          display: flex;\r\n          \r\n          .label {\r\n            font-weight: 500;\r\n            color: #666;\r\n            margin-right: 10px;\r\n            min-width: 80px;\r\n          }\r\n          \r\n          .value {\r\n            color: #333;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.dialog-footer {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n/* Print Preview Mode (Screen) */\r\n@media screen {\r\n  .po-preview-modal .preview-container.print-preview-mode {\r\n    width: 210mm !important;\r\n    min-height: 297mm !important;\r\n    margin: 0 auto 20px !important;\r\n    background: white !important;\r\n    box-shadow: 0 0 10px rgba(0,0,0,0.1) !important;\r\n    padding: 10mm 10mm 15mm 25mm !important;  /* 減少上下內距，增加左內距減少右內距 */\r\n    box-sizing: border-box !important;\r\n    transform-origin: top center;\r\n    overflow: visible !important;\r\n    position: relative !important;\r\n    \r\n    /* Multiple page support */\r\n    &.page-2 {\r\n      min-height: 594mm !important;\r\n    }\r\n    \r\n    /* Page boundary visualization */\r\n    &::after {\r\n      content: 'Page 1 boundary';\r\n      position: absolute;\r\n      top: 297mm;\r\n      left: 0;\r\n      right: 0;\r\n      border-top: 2px dashed #ff0000;\r\n      pointer-events: none;\r\n      z-index: 1000;\r\n      font-size: 10px;\r\n      color: #ff0000;\r\n      text-align: center;\r\n      padding-top: 2px;\r\n    }\r\n    \r\n    .company-header {\r\n      max-height: 40mm !important;  /* 減少高度 */\r\n      margin-bottom: 3mm !important;  /* 減少間距 */\r\n      \r\n      .title {\r\n        font-size: 20pt !important;\r\n      }\r\n      \r\n      .subtitle {\r\n        font-size: 12pt !important;\r\n      }\r\n    }\r\n    \r\n    .info-table-section {\r\n      margin-bottom: 5mm !important;\r\n      \r\n      .info-table td {\r\n        padding: 1.5mm !important;\r\n        font-size: 9pt !important;\r\n      }\r\n    }\r\n    \r\n    .section {\r\n      margin-bottom: 5mm !important;\r\n      \r\n      .section-title {\r\n        font-size: 10pt !important;\r\n        margin-bottom: 2mm !important;\r\n      }\r\n    }\r\n    \r\n    .totals-section {\r\n      margin: 3mm 0 3mm 0 !important;  /* 移除右邊距，避免內容被推向右側 */\r\n\r\n      .total-row {\r\n        font-size: 9pt !important;\r\n        margin-bottom: 1mm !important;\r\n      }\r\n    }\r\n    \r\n    .terms-section {\r\n      max-height: 45mm !important;  /* 適度增加高度 */\r\n      overflow: hidden !important;  /* 保持 hidden 避免重複顯示 */\r\n\r\n      .el-textarea__inner {\r\n        font-size: 8pt !important;\r\n        line-height: 1.2 !important;\r\n      }\r\n    }\r\n    \r\n    .signature-section {\r\n      max-height: 25mm !important;\r\n      margin-top: 8mm !important;  /* 增加簽名區域上方間距 */\r\n      \r\n      .signature-row {\r\n        height: 10mm !important;\r\n      }\r\n    }\r\n    \r\n    /* Hide elements that would cause page overflow */\r\n    .non-printable-section {\r\n      display: none !important;\r\n    }\r\n    \r\n    /* Table optimizations for print preview */\r\n    .el-table {\r\n      font-size: 7pt !important;\r\n      table-layout: fixed !important;\r\n      width: 100% !important;\r\n      \r\n      th, td {\r\n        padding: 1mm 0.5mm !important;\r\n        line-height: 1.1 !important;\r\n        overflow: hidden !important;\r\n        text-overflow: ellipsis !important;\r\n      }\r\n      \r\n      /* Optimized column widths */\r\n      .el-table__column:nth-child(1) { width: 8% !important; }  /* 項次 */\r\n      .el-table__column:nth-child(2) { width: 22% !important; } /* 品名 */\r\n      .el-table__column:nth-child(3) { width: 18% !important; } /* 規格 */\r\n      .el-table__column:nth-child(4) { width: 12% !important; } /* 型號 */\r\n      .el-table__column:nth-child(5) { width: 8% !important; }  /* 數量 */\r\n      .el-table__column:nth-child(6) { width: 6% !important; }  /* 單位 */\r\n      .el-table__column:nth-child(7) { width: 10% !important; } /* 單價 */\r\n      .el-table__column:nth-child(8) { width: 11% !important; } /* 小計 */\r\n      .el-table__column:nth-child(9) { width: 5% !important; }  /* 備註 */\r\n    }\r\n    \r\n    /* Currency display without NT$ */\r\n    .print-currency::before {\r\n      content: '$';\r\n    }\r\n  }\r\n}\r\n\r\n/* Complete Print Stylesheet */\r\n@media print {\r\n  /* Page Setup */\r\n  @page {\r\n    size: A4 portrait;\r\n    margin: 20mm 10mm 20mm 25mm;  /* 調整邊距：上20mm 右10mm 下20mm 左25mm - 增加左邊距，減少右邊距讓內容居中 */\r\n\r\n    /* Print optimization */\r\n    -webkit-print-color-adjust: exact;\r\n    color-adjust: exact;\r\n    print-color-adjust: exact;\r\n  }\r\n  \r\n  @page :first {\r\n    margin-top: 20mm;  /* 保持與主要設定一致 */\r\n  }\r\n\r\n  @page :left {\r\n    margin-left: 25mm;  /* 增加左邊距 */\r\n    margin-right: 10mm;  /* 減少右邊距 */\r\n  }\r\n\r\n  @page :right {\r\n    margin-left: 25mm;  /* 增加左邊距 */\r\n    margin-right: 10mm;  /* 減少右邊距 */\r\n  }\r\n  \r\n  /* Hide non-printable elements */\r\n  .el-dialog__wrapper,\r\n  .el-dialog__header,\r\n  .dialog-footer,\r\n  .terms-selector,\r\n  .non-printable-section,\r\n  .el-loading-mask,\r\n  .el-input,\r\n  .el-select,\r\n  .status-info,\r\n  .export-history {\r\n    display: none !important;\r\n  }\r\n  \r\n  /* Main container adjustments */\r\n  .po-preview-modal .el-dialog,\r\n  .po-preview-modal .el-dialog__body,\r\n  .preview-container {\r\n    width: 100% !important;\r\n    max-width: 170mm !important;  /* 減少寬度使內容更居中 */\r\n    height: auto !important;\r\n    padding: 0 !important;\r\n    margin: 0 auto !important;  /* 添加 auto 使內容水平置中 */\r\n    box-shadow: none !important;\r\n    border: none !important;\r\n    border-radius: 0 !important;\r\n    background: white !important;\r\n    color: black !important;\r\n  }\r\n  \r\n  /* Company Header */\r\n  .company-header {\r\n    max-height: 40mm !important;  /* 統一減少高度避免被截斷 */\r\n    display: flex !important;\r\n    align-items: center !important;\r\n    justify-content: space-between !important;\r\n    border-bottom: 1.5pt solid #000 !important;\r\n    margin-bottom: 5mm !important;\r\n    page-break-inside: avoid !important;\r\n    padding-bottom: 3mm !important;\r\n  }\r\n  \r\n  .company-logo {\r\n    max-width: 45mm !important;\r\n    max-height: 30mm !important;\r\n    object-fit: contain !important;\r\n  }\r\n  \r\n  .title {\r\n    font-size: 20pt !important;\r\n    font-weight: bold !important;\r\n    line-height: 1.1 !important;\r\n    color: #000 !important;\r\n  }\r\n  \r\n  .subtitle {\r\n    font-size: 12pt !important;\r\n    font-weight: normal !important;\r\n    line-height: 1.1 !important;\r\n    color: #333 !important;\r\n  }\r\n  \r\n  /* Supplier Information Table */\r\n  .info-table-section {\r\n    margin-bottom: 8mm !important;\r\n    page-break-inside: avoid !important;\r\n  }\r\n  \r\n  .info-table {\r\n    width: 100% !important;\r\n    max-height: 35mm !important;\r\n    border-collapse: collapse !important;\r\n    page-break-inside: avoid !important;\r\n  }\r\n  \r\n  .info-table td {\r\n    padding: 2mm !important;\r\n    border: 0.5pt solid #333 !important;\r\n    vertical-align: middle !important;\r\n    font-size: 10pt !important;\r\n    line-height: 1.2 !important;\r\n    color: #000 !important;\r\n  }\r\n  \r\n  .info-table .label {\r\n    width: 35mm !important;\r\n    background: #f0f0f0 !important;\r\n    font-weight: 600 !important;\r\n    -webkit-print-color-adjust: exact !important;\r\n    print-color-adjust: exact !important;\r\n  }\r\n  \r\n  .info-table .value {\r\n    width: 55mm !important;\r\n  }\r\n  \r\n  /* Purchase Items Table */\r\n  .el-table {\r\n    font-size: 7.5pt !important;\r\n    line-height: 1.1 !important;\r\n    border-collapse: collapse !important;\r\n    width: 100% !important;\r\n    margin-bottom: 5mm !important;\r\n    table-layout: fixed !important;\r\n  }\r\n  \r\n  .el-table th {\r\n    background: #f5f5f5 !important;\r\n    font-size: 8pt !important;\r\n    font-weight: 600 !important;\r\n    padding: 1.5mm 1mm !important;\r\n    border: 0.5pt solid #333 !important;\r\n    color: #000 !important;\r\n    -webkit-print-color-adjust: exact !important;\r\n    print-color-adjust: exact !important;\r\n  }\r\n  \r\n  .el-table td {\r\n    padding: 1mm 0.5mm !important;\r\n    border: 0.5pt solid #333 !important;\r\n    font-size: 7.5pt !important;\r\n    color: #000 !important;\r\n    overflow: hidden !important;\r\n    text-overflow: ellipsis !important;\r\n    white-space: nowrap !important;\r\n  }\r\n  \r\n  /* Special handling for text columns */\r\n  .el-table td:nth-child(2),\r\n  .el-table td:nth-child(3),\r\n  .el-table td:nth-child(4) {\r\n    white-space: normal !important;\r\n    word-break: break-all !important;\r\n    line-height: 1.1 !important;\r\n  }\r\n  \r\n  .el-table .cell {\r\n    line-height: 1.2 !important;\r\n    word-break: break-word !important;\r\n    overflow: hidden !important;\r\n    padding: 0 !important;\r\n  }\r\n  \r\n  /* Column-specific widths optimized for A4 */\r\n  .el-table {\r\n    table-layout: fixed !important;\r\n    width: 100% !important;\r\n  }\r\n  \r\n  .el-table .el-table__cell:nth-child(1) { width: 12mm !important; } /* 項次 */\r\n  .el-table .el-table__cell:nth-child(2) { width: 38mm !important; } /* 品名 */\r\n  .el-table .el-table__cell:nth-child(3) { width: 30mm !important; } /* 規格 */\r\n  .el-table .el-table__cell:nth-child(4) { width: 20mm !important; } /* 型號 */\r\n  .el-table .el-table__cell:nth-child(5) { width: 14mm !important; } /* 數量 */\r\n  .el-table .el-table__cell:nth-child(6) { width: 11mm !important; } /* 單位 */\r\n  .el-table .el-table__cell:nth-child(7) { width: 17mm !important; } /* 單價 */\r\n  .el-table .el-table__cell:nth-child(8) { width: 19mm !important; } /* 小計 */\r\n  .el-table .el-table__cell:nth-child(9) { width: 9mm !important; } /* 備註 */\r\n  \r\n  /* Totals Section */\r\n  .totals-section {\r\n    max-height: 20mm !important;\r\n    margin: 5mm 0 5mm 0 !important;  /* 移除左右邊距，使用頁面邊距控制 */\r\n    text-align: right !important;\r\n    display: flex !important;\r\n    flex-direction: column !important;\r\n    align-items: flex-end !important;  /* 讓內容靠右對齊 */\r\n    justify-content: center !important;\r\n    page-break-inside: avoid !important;\r\n  }\r\n\r\n  .total-row {\r\n    margin-bottom: 2mm !important;\r\n    font-size: 11pt !important;\r\n    line-height: 1.3 !important;\r\n    color: #000 !important;\r\n    display: flex !important;\r\n    justify-content: flex-end !important;  /* 確保每一行都靠右對齊 */\r\n  }\r\n  \r\n  .grand-total {\r\n    font-size: 12pt !important;\r\n    font-weight: bold !important;\r\n    border-top: 1pt solid #333 !important;\r\n    padding-top: 2mm !important;\r\n    margin-top: 2mm !important;\r\n  }\r\n  \r\n  /* Terms & Conditions */\r\n  .section {\r\n    margin-bottom: 5mm !important;\r\n    page-break-inside: avoid !important;\r\n  }\r\n  \r\n  .section-title {\r\n    font-size: 11pt !important;\r\n    font-weight: bold !important;\r\n    margin-bottom: 2mm !important;\r\n    color: #000 !important;\r\n    border-bottom: 1pt solid #333 !important;\r\n    padding-bottom: 1mm !important;\r\n  }\r\n  \r\n  .terms-section {\r\n    max-height: 40mm !important;  /* 減少高度避免超出頁面 */\r\n    min-height: 25mm !important;  /* 減少最小高度 */\r\n    overflow: hidden !important;  /* 保持 hidden 避免重複顯示 */\r\n    page-break-inside: avoid !important;\r\n  }\r\n  \r\n  /* Terms content handling for textarea */\r\n  .el-textarea__inner {\r\n    display: none !important;\r\n  }\r\n  \r\n  /* Show print-only terms display */\r\n  .terms-print-content {\r\n    display: block !important;\r\n    font-size: 8.5pt !important;  /* 稍微縮小字體 */\r\n    line-height: 1.3 !important;  /* 調整行距 */\r\n    white-space: pre-wrap !important;  /* 使用 pre-wrap 確保換行正確 */\r\n    border: 0.5pt solid #ccc !important;\r\n    padding: 2.5mm !important;  /* 減少內距 */\r\n    min-height: 28mm !important;  /* 減少最小高度 */\r\n    max-height: 38mm !important;  /* 減少最大高度 */\r\n    height: auto !important;  /* 高度自動調整 */\r\n    overflow: hidden !important;  /* 使用 hidden 避免超出 */\r\n    color: #000 !important;\r\n  }\r\n  \r\n  /* Signature Section */\r\n  .signature-section {\r\n    max-height: 20mm !important;  /* 減少高度 */\r\n    margin-top: 5mm !important;  /* 減少上方間距 */\r\n    page-break-inside: avoid !important;\r\n    page-break-before: auto !important;\r\n  }\r\n  \r\n  .signature-row {\r\n    height: 10mm !important;\r\n    display: flex !important;\r\n    justify-content: space-between !important;\r\n    align-items: center !important;\r\n    margin-bottom: 5mm !important;\r\n  }\r\n  \r\n  .signature-item {\r\n    display: flex !important;\r\n    align-items: center !important;\r\n    width: 80mm !important;\r\n    font-size: 10pt !important;\r\n    color: #000 !important;\r\n  }\r\n  \r\n  .signature-line {\r\n    width: 60mm !important;\r\n    border-bottom: 1pt solid #333 !important;\r\n    height: 1pt !important;\r\n    margin-left: 5mm !important;\r\n  }\r\n  \r\n  /* Page break management */\r\n  .company-header,\r\n  .info-table-section {\r\n    page-break-inside: avoid !important;\r\n    page-break-after: auto !important;\r\n  }\r\n  \r\n  .el-table {\r\n    page-break-inside: auto !important;\r\n  }\r\n  \r\n  .el-table tbody tr {\r\n    page-break-inside: avoid !important;\r\n    page-break-after: auto !important;\r\n  }\r\n  \r\n  .totals-section,\r\n  .terms-section,\r\n  .signature-section {\r\n    page-break-inside: avoid !important;\r\n    page-break-before: auto !important;\r\n  }\r\n  \r\n  /* Ensure proper page breaks */\r\n  h3 {\r\n    page-break-after: avoid !important;\r\n    page-break-before: auto !important;\r\n  }\r\n  \r\n  /* Currency formatting in print */\r\n  .print-currency::before {\r\n    content: '$';\r\n  }\r\n}\r\n\r\n/* Browser-specific print adjustments */\r\n@media print and (-webkit-min-device-pixel-ratio: 0) {\r\n  .company-header {\r\n    -webkit-print-color-adjust: exact;\r\n  }\r\n  \r\n  .info-table .label {\r\n    -webkit-print-color-adjust: exact;\r\n  }\r\n}\r\n\r\n/* Firefox print adjustments */\r\n@-moz-document url-prefix() {\r\n  @media print {\r\n    .el-table th {\r\n      background: #f5f5f5 !important;\r\n      color-adjust: exact;\r\n    }\r\n    \r\n    .info-table .label {\r\n      background: #f0f0f0 !important;\r\n      color-adjust: exact;\r\n    }\r\n  }\r\n}\r\n</style>","<template>\r\n  <div class=\"purchase-orders-list\">\r\n    <div class=\"page-header\">\r\n      <h1 class=\"page-title\">採購單列表</h1>\r\n      <div class=\"header-actions\">\r\n        <el-button type=\"primary\" @click=\"buildFromRequisitions\">\r\n          <el-icon><DocumentCopy /></el-icon>\r\n          建立採購單\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"filters\">\r\n      <el-form :model=\"filters\" inline>\r\n        <el-form-item label=\"供應商\">\r\n          <el-select \r\n            v-model=\"filters.supplier\" \r\n            placeholder=\"選擇供應商\" \r\n            clearable\r\n            style=\"width: 200px\"\r\n          >\r\n            <el-option label=\"全部\" value=\"\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"狀態\">\r\n          <el-select \r\n            v-model=\"filters.status\" \r\n            placeholder=\"選擇狀態\" \r\n            clearable\r\n            style=\"width: 150px\"\r\n          >\r\n            <el-option label=\"全部\" value=\"\" />\r\n            <el-option label=\"已建立\" value=\"order_created\" />\r\n            <el-option label=\"已製單\" value=\"outputted\" />\r\n            <el-option label=\"已採購\" value=\"purchased\" />\r\n            <el-option label=\"已發貨\" value=\"shipped\" />\r\n            <el-option label=\"已撤銷\" value=\"cancelled\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"loadPurchaseOrders\">搜尋</el-button>\r\n          <el-button @click=\"resetFilters\">重設</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <div class=\"table-container\">\r\n      <el-table \r\n        :data=\"purchaseOrders\" \r\n        :loading=\"loading\"\r\n        stripe\r\n        @row-click=\"viewDetail\"\r\n      >\r\n        <el-table-column prop=\"purchase_order_no\" label=\"採購單號\" width=\"140\" />\r\n        <el-table-column prop=\"supplier_name\" label=\"供應商\" width=\"160\" />\r\n        <el-table-column prop=\"grand_total_int\" label=\"總金額\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            {{ formatCurrency(row.grand_total_int) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"purchase_status\" label=\"狀態\" width=\"90\">\r\n          <template #default=\"{ row }\">\r\n            <el-tag :type=\"getStatusType(row.purchase_status)\">\r\n              {{ getStatusText(row.purchase_status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"output_person_name\" label=\"製單人\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            <el-popover\r\n              v-if=\"row.output_person_name\"\r\n              placement=\"top\"\r\n              width=\"220\"\r\n              trigger=\"hover\"\r\n            >\r\n              <template #reference>\r\n                <span class=\"user-name\">{{ row.output_person_name }}</span>\r\n              </template>\r\n              <div class=\"user-popover\">\r\n                <p><strong>製單人資訊</strong></p>\r\n                <p>姓名: {{ row.output_person_name }}</p>\r\n                <p>帳號: {{ row.output_person_username }}</p>\r\n                <p>製單時間: {{ formatDate(row.output_timestamp) }}</p>\r\n              </div>\r\n            </el-popover>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"confirm_purchaser_name\" label=\"採購人\" width=\"100\">\r\n          <template #default=\"{ row }\">\r\n            <el-popover\r\n              v-if=\"row.confirm_purchaser_name\"\r\n              placement=\"top\"\r\n              width=\"220\"\r\n              trigger=\"hover\"\r\n            >\r\n              <template #reference>\r\n                <span class=\"user-name\">{{ row.confirm_purchaser_name }}</span>\r\n              </template>\r\n              <div class=\"user-popover\">\r\n                <p><strong>採購人資訊</strong></p>\r\n                <p>姓名: {{ row.confirm_purchaser_name }}</p>\r\n                <p>帳號: {{ row.confirm_purchaser_username }}</p>\r\n                <p>採購時間: {{ formatDate(row.confirm_timestamp) }}</p>\r\n              </div>\r\n            </el-popover>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"created_at\" label=\"建立時間\" width=\"160\">\r\n          <template #default=\"{ row }\">\r\n            {{ formatDate(row.created_at) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"300\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <el-button size=\"small\" @click.stop=\"viewDetail(row)\">詳情</el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"primary\" \r\n              @click.stop=\"editPO(row)\"\r\n              v-if=\"canEdit(row)\"\r\n            >\r\n              編輯\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"success\" \r\n              @click.stop=\"handleOutput(row)\"\r\n              v-if=\"canOutput(row)\"\r\n            >\r\n              輸出\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"warning\" \r\n              @click.stop=\"confirmPurchase(row)\"\r\n              v-if=\"canConfirmPurchase(row)\"\r\n            >\r\n              確認採購\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click.stop=\"withdrawPO(row)\"\r\n              v-if=\"canWithdraw(row)\"\r\n            >\r\n              撤銷\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n          v-model:current-page=\"pagination.page\"\r\n          v-model:page-size=\"pagination.size\"\r\n          :total=\"pagination.total\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :prev-text=\"'上一頁'\"\r\n          :next-text=\"'下一頁'\"\r\n          background\r\n          @size-change=\"loadPurchaseOrders\"\r\n          @current-change=\"loadPurchaseOrders\"\r\n        >\r\n          <template #sizes>\r\n            <el-select\r\n              :model-value=\"pagination.size\"\r\n              @update:model-value=\"loadPurchaseOrders\"\r\n              style=\"width: 100px\"\r\n              size=\"small\"\r\n            >\r\n              <el-option\r\n                v-for=\"size in [10, 20, 50, 100]\"\r\n                :key=\"size\"\r\n                :label=\"`${size}筆/頁`\"\r\n                :value=\"size\"\r\n              />\r\n            </el-select>\r\n          </template>\r\n          <template #total>\r\n            <span class=\"pagination-total\">共 {{ pagination.total }} 筆</span>\r\n          </template>\r\n        </el-pagination>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Preview Modal -->\r\n    <PreviewModal \r\n      v-model:visible=\"previewModalVisible\"\r\n      :po-no=\"selectedPONo\"\r\n      @exported=\"handleExported\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage, ElMessageBox, ElPopover } from 'element-plus'\r\nimport { DocumentCopy } from '@element-plus/icons-vue'\r\nimport { formatDate, formatCurrency } from '@/utils/format'\r\nimport { procurementApi } from '@/api/procurement'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport PreviewModal from './PreviewModal.vue'\r\n\r\nconst router = useRouter()\r\nconst authStore = useAuthStore()\r\n\r\n// Reactive data\r\nconst loading = ref(false)\r\nconst purchaseOrders = ref([])\r\nconst filters = ref({\r\n  supplier: '',\r\n  status: ''  // 空字串表示全部，不設定預設篩選\r\n})\r\n\r\nconst pagination = ref({\r\n  page: 1,\r\n  size: 20,\r\n  total: 0\r\n})\r\n\r\nconst previewModalVisible = ref(false)\r\nconst selectedPONo = ref('')\r\n\r\n// Methods\r\nconst loadPurchaseOrders = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await procurementApi.getPurchaseOrders({\r\n      ...filters.value,\r\n      page: pagination.value.page,\r\n      page_size: pagination.value.size\r\n    })\r\n    purchaseOrders.value = response.items\r\n    pagination.value.total = response.pagination.total\r\n  } catch (error) {\r\n    console.error('載入採購單列表失敗:', error)\r\n    ElMessage.error('載入採購單列表失敗')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst resetFilters = () => {\r\n  filters.value = {\r\n    supplier: '',\r\n    status: ''\r\n  }\r\n  pagination.value.page = 1\r\n  loadPurchaseOrders()\r\n}\r\n\r\nconst buildFromRequisitions = () => {\r\n  router.push('/purchase-orders/build-candidates')\r\n}\r\n\r\n\r\nconst viewDetail = (row: any) => {\r\n  router.push(`/purchase-orders/${row.purchase_order_no}`)\r\n}\r\n\r\nconst editPO = (row: any) => {\r\n  router.push(`/purchase-orders/${row.purchase_order_no}/edit`)\r\n}\r\n\r\nconst canEdit = (row: any) => {\r\n  return ['order_created', 'pending'].includes(row.purchase_status)\r\n}\r\n\r\nconst canOutput = (row: any) => {\r\n  return true // 所有狀態都可以輸出\r\n}\r\n\r\nconst canConfirmPurchase = (row: any) => {\r\n  // 只有狀態為 \"已製單\" (outputted) 的採購單可以確認採購\r\n  return row.purchase_status === 'outputted'\r\n}\r\n\r\nconst canWithdraw = (row: any) => {\r\n  // 只有採購主管和系統管理員可以撤銷，且狀態不能為已撤銷\r\n  return authStore.hasRole('ProcurementMgr', 'Admin') && row.purchase_status !== 'cancelled'\r\n}\r\n\r\nconst handleOutput = (row: any) => {\r\n  selectedPONo.value = row.purchase_order_no\r\n  previewModalVisible.value = true\r\n}\r\n\r\nconst handleExported = () => {\r\n  loadPurchaseOrders()\r\n  // 移除成功訊息，避免列印時顯示\r\n  // ElMessage.success('採購單已成功輸出')\r\n}\r\n\r\nconst confirmPurchase = async (row: any) => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      `確定要將採購單 ${row.purchase_order_no} 狀態更改為已採購嗎？`,\r\n      '確認採購',\r\n      {\r\n        confirmButtonText: '確定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }\r\n    )\r\n    \r\n    loading.value = true\r\n    const response = await procurementApi.confirmPurchase(row.purchase_order_no)\r\n    \r\n    if (response.success) {\r\n      ElMessage.success('採購單已確認採購')\r\n      loadPurchaseOrders()\r\n    } else {\r\n      ElMessage.error(response.message || '確認採購失敗')\r\n    }\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      console.error('確認採購失敗:', error)\r\n      ElMessage.error('確認採購失敗')\r\n    }\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst withdrawPO = async (row: any) => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      `是否確定要撤銷該張採購單 ${row.purchase_order_no}？`,\r\n      '確認撤銷',\r\n      {\r\n        confirmButtonText: '確定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }\r\n    )\r\n    \r\n    loading.value = true\r\n    const response = await procurementApi.cancelPO(row.purchase_order_no, {\r\n      reason: '管理員撤銷採購單'\r\n    })\r\n    \r\n    if (response.success) {\r\n      ElMessage.success('採購單已撤銷')\r\n      loadPurchaseOrders()\r\n    } else {\r\n      ElMessage.error(response.message || '撤銷失敗')\r\n    }\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      console.error('撤銷採購單失敗:', error)\r\n      ElMessage.error('撤銷採購單失敗')\r\n    }\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst getStatusType = (status: string) => {\r\n  const statusMap: Record<string, string> = {\r\n    pending: 'info',\r\n    confirmed: 'primary', \r\n    order_created: '',\r\n    outputted: 'primary',\r\n    purchased: 'success',\r\n    shipped: 'warning',\r\n    cancelled: 'info'\r\n  }\r\n  return statusMap[status] || 'info'\r\n}\r\n\r\nconst getStatusText = (status: string) => {\r\n  const statusMap: Record<string, string> = {\r\n    pending: '已建立',\r\n    confirmed: '已製單',\r\n    order_created: '已建立',\r\n    outputted: '已製單',\r\n    purchased: '已採購',\r\n    shipped: '已發貨',\r\n    cancelled: '已撤銷'\r\n  }\r\n  return statusMap[status] || status\r\n}\r\n\r\nonMounted(() => {\r\n  // 不設定預設篩選，顯示所有採購單\r\n  loadPurchaseOrders()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.purchase-orders-list {\r\n  padding: 20px;\r\n}\r\n\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n\r\n  .header-actions {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.page-title {\r\n  margin: 0;\r\n  font-size: 24px;\r\n  color: #303133;\r\n}\r\n\r\n.filters {\r\n  background: #f5f7fa;\r\n  padding: 20px;\r\n  border-radius: 4px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.table-container {\r\n  background: white;\r\n  border-radius: 4px;\r\n  padding: 20px;\r\n}\r\n\r\n.pagination {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n.user-name {\r\n  color: #303133;\r\n  cursor: default;\r\n}\r\n\r\n.user-popover {\r\n  p {\r\n    margin: 5px 0;\r\n    font-size: 13px;\r\n  }\r\n  p:first-child {\r\n    margin-bottom: 10px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    padding-bottom: 5px;\r\n  }\r\n}\r\n</style>"],"names":["_imports_0","downloadFile","blob","filename","link","url","evt","downloadFromAPI","method","data","token","headers","options","response","contentDisposition","filenameMatch","contentType","ext","props","__props","emit","__emit","dialogVisible","ref","loading","exporting","printing","isExporting","poData","companyInfo","selectedTermsTemplate","termsContent","itemsWithIndex","computed","item","index","canExport","statusDisplay","exportHistoryDisplay","lastExportDate","watch","newVal","loadPreviewData","procurementApi","loadTermsTemplate","error","ElMessage","templateId","templates","handleClose","handleExport","format","apiUrl","_b","_a","printPreviewMode","togglePrintPreview","handlePrint","termsSection","termsPrintContent","formatDate","date","formatNumber","num","formatCurrency","amount","includePrefix","globalFormatCurrency","_cache","$event","_createElementVNode","_hoisted_50","_createVNode","_component_el_button","_withCtx","_createTextVNode","_toDisplayString","_component_el_icon","_unref","Download","Document","Printer","_withDirectives","_openBlock","_createElementBlock","_normalizeClass","_hoisted_3","_hoisted_4","_createCommentVNode","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_component_el_input","_hoisted_13","_hoisted_14","_component_el_table","_component_el_table_column","scope","_hoisted_17","_hoisted_21","_component_el_select","_component_el_option","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_29","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_36","_hoisted_38","_hoisted_39","_hoisted_41","_hoisted_42","_hoisted_44","_hoisted_46","_hoisted_47","_hoisted_49","router","useRouter","authStore","useAuthStore","purchaseOrders","filters","pagination","previewModalVisible","selectedPONo","loadPurchaseOrders","resetFilters","buildFromRequisitions","viewDetail","row","editPO","canEdit","canOutput","canConfirmPurchase","canWithdraw","handleOutput","handleExported","confirmPurchase","ElMessageBox","withdrawPO","getStatusType","status","getStatusText","onMounted","_hoisted_1","_hoisted_2","DocumentCopy","_component_el_form","_component_el_form_item","_component_el_tag","_createBlock","ElPopover","_withModifiers","_component_el_pagination","_Fragment","_renderList","size"],"mappings":"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"}