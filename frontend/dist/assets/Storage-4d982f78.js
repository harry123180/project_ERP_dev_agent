import{d as Pe,u as Te,r as g,a as oe,p as pe,a1 as Ze,c as E,b as n,e,w as a,X as b,Y as ne,al as Me,a4 as Re,T as Be,o as c,g as V,a7 as se,i as r,ap as Ne,q as h,bb as fe,bc as je,bd as Ge,be as Oe,t as u,ab as j,aq as ie,b7 as We,aG as He,bf as Ke,aH as Je,aP as Qe,F as I,s as F,aB as Xe,H as Ye,I as el,m as ll,ao as al,bg as tl,bh as ol,av as nl,aQ as sl,aw as il,aO as dl,aj as rl,j as ul,k as cl,aF as pl,E as fl,aJ as _l,aK as ml,ah as vl,ai as yl,aS as gl,_ as bl}from"./index-61294aba.js";/* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                             *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                *//* empty css                *//* empty css                        *//* empty css                  *//* empty css                       */const hl={class:"storage-management"},Vl={class:"structure-section"},wl={class:"card-header"},kl={class:"structure-tree"},Cl={class:"tree-node"},El={class:"node-info"},$l={class:"node-label"},xl={class:"node-actions"},Sl={class:"pending-section"},Ul={class:"card-header"},zl={class:"manual-entry-section"},ql={class:"card-header"},Dl={class:"manual-entry-description"},Al={class:"stats-section"},Il={class:"stat-item"},Fl={class:"stat-value"},Ll={class:"stat-item"},Pl={class:"stat-value"},Tl={class:"stat-item"},Zl={class:"stat-value"},Ml={class:"stat-item"},Rl={class:"stat-value"},Bl={class:"shelves-config",style:{"max-height":"300px","overflow-y":"auto"}},Nl={key:0,class:"assign-content"},jl={class:"item-info"},Gl={class:"location-selection"},Ol={key:0,class:"position-detail"},Wl={class:"basic-info"},Hl={class:"inventory-info"},Kl={class:"movement-history"},Jl=Pe({__name:"Storage",setup(Ql){Te();const x=g([]),z=g([]),T=g([]),K=g(!1),J=g(!1),Q=g(!1),Z=g(!1),M=g(!1),X=g(!1),R=g(!1),Y=g(!1),v=g(null),k=g(null),_e={children:"children",label:"label"},p=oe({area_code:"",area_name:"",shelves:[{shelf_code:"A",floors:6,description:""}]}),f=oe({area:"",shelf:"",floor:1}),i=oe({item_name:"",specification:"",quantity:1,unit:"",area:"",shelf:"",floor:1,remarks:""}),me={area_code:[{required:!0,message:"請輸入區域代碼",trigger:"blur"}]},ve={item_name:[{required:!0,message:"請輸入物料名稱",trigger:"blur"}],specification:[{required:!0,message:"請輸入物料規格",trigger:"blur"}],quantity:[{required:!0,message:"請輸入數量",trigger:"blur"}]},G=g([]),O=g([]),B=g([]),ee=pe(()=>{let o=0,l=0;const d=s=>{for(const w of s)w.type==="floor"&&(o+=w.capacity||0,l+=w.used||0),w.children&&d(w.children)};return d(x.value),{totalPositions:o,usedPositions:l,utilizationRate:o>0?Math.round(l/o*100):0}}),ye=pe(()=>f.area&&f.shelf&&f.floor),W=async()=>{try{x.value=[{id:"z1",label:"Z1 區",type:"area",children:[{id:"z1-a",label:"A 貨架",type:"shelf",children:[{id:"z1-a-1",label:"第1層",type:"floor",storage_id:"Z1-A-1",capacity:6,used:1,utilization:17,children:[]}]}]}],G.value=x.value.filter(o=>o.type==="area").map(o=>({code:o.id.toUpperCase(),label:o.label}))}catch{b.error("載入倉庫結構失敗")}},ge=async()=>{try{K.value=!0;const o=await ne.getPendingStorageItems();z.value=o}catch(o){console.error("Failed to load pending storage items:",o),b.error("載入待入庫物料失敗")}finally{K.value=!1}},be=o=>{T.value=o},he=()=>{p.shelves.push({shelf_code:"",floors:6,description:""})},Ve=o=>{p.shelves.splice(o,1)},we=async()=>{try{if(J.value=!0,!p.area_code||!p.area_name){b.warning("請填寫區域代碼和名稱");return}if(x.value.find(s=>s.id===p.area_code.toLowerCase())){b.error(`區域代碼 ${p.area_code} 已存在`);return}const l=new Set;x.value.forEach(s=>{s.children&&s.children.forEach(w=>{const D=w.label.split(" ")[0];l.add(D)})});for(const s of p.shelves)if(s.shelf_code&&l.has(s.shelf_code)){b.error(`貨架代碼 ${s.shelf_code} 已在其他區域使用，請使用不同的代碼`);return}const d={id:p.area_code.toLowerCase(),label:`${p.area_code} ${p.area_name}`,type:"area",children:[]};p.shelves.forEach((s,w)=>{if(s.shelf_code){const D={id:`${d.id}-${s.shelf_code.toLowerCase()}`,label:`${s.shelf_code} 貨架`,type:"shelf",children:[]};for(let A=1;A<=s.floors;A++){const S={id:`${D.id}-${A}`,label:`第${A}層`,type:"floor",storage_id:`${p.area_code}-${s.shelf_code}-${A}`,capacity:6,used:0,utilization:0,children:[]};D.children.push(S)}d.children.push(D)}}),x.value.push(d),G.value.push({code:p.area_code,label:`${p.area_code} ${p.area_name}`}),b.success("區域建立成功"),Z.value=!1,p.area_code="",p.area_name="",p.shelves=[{shelf_code:"A",floors:6,description:""}]}catch{b.error("建立區域失敗")}finally{J.value=!1}},ke=o=>{v.value=o,f.area="",f.shelf="",f.floor=1,M.value=!0},de=()=>{f.shelf="",f.floor=1;const o=x.value.find(l=>l.id===f.area.toLowerCase());o&&o.children?O.value=o.children.filter(l=>l.type==="shelf").map(l=>({code:l.label.split(" ")[0],label:l.label})):O.value=[]},re=()=>{f.floor=1;const o=x.value.find(l=>l.id===f.area.toLowerCase());if(o&&o.children){const l=o.children.find(d=>d.label.split(" ")[0]===f.shelf);l&&l.children?B.value=l.children.filter(d=>d.type==="floor").map(d=>{const s=d.label.match(/第(\d+)層/);return s?parseInt(s[1]):1}):B.value=[]}else B.value=[]},Ce=async()=>{try{Q.value=!0;const o={item_ref:{id:v.value.id,po_no:v.value.source_po_number,item_name:v.value.item_name,quantity:v.value.quantity,receiver:v.value.receiver,arrival_date:v.value.arrival_date},area:f.area,shelf:f.shelf,floor:f.floor};await ne.assignStorageLocation(o);const l=z.value.findIndex(d=>d.id===v.value.id);l>=0&&z.value.splice(l,1),b.success("儲位指定成功，物料已完成入庫並移除待入庫清單"),M.value=!1,await W()}catch(o){console.error("Failed to assign storage location:",o),b.error("指定儲位失敗")}finally{Q.value=!1}},Ee=async()=>{try{await Ye.confirm(`確認批量入庫 ${T.value.length} 項物料？`,"批量入庫",{type:"warning"});const o=T.value.map(l=>l.id);z.value=z.value.filter(l=>!o.includes(l.id)),T.value=[],b.success("批量入庫成功，物料已移除待入庫清單")}catch{}},$e=async o=>{b.info(`查看樓層詳情: ${o.label} - 容量: ${o.used}/${o.capacity}`)},xe=o=>{b.info("編輯樓層功能開發中")},Se=async()=>{try{if(Y.value=!0,!i.area||!i.shelf||!i.floor){b.warning("請選擇完整的儲存位置");return}const o={item_name:i.item_name,specification:i.specification,quantity:i.quantity,unit:i.unit,storage_location:{area:i.area,shelf:i.shelf,floor:i.floor},remarks:i.remarks};await ne.createManualEntry(o),b.success("手動入庫成功"),R.value=!1,i.item_name="",i.specification="",i.quantity=1,i.unit="",i.area="",i.shelf="",i.floor=1,i.remarks="",await W()}catch(o){console.error("Failed to create manual entry:",o),b.error("手動入庫失敗")}finally{Y.value=!1}},Ue=o=>{o.expanded=!o.expanded},ze=o=>{window.open(`/purchase-orders/${o}`,"_blank")},qe=o=>o>=90?"danger":o>=70?"warning":o>=30?"success":"info",De=(o,l)=>{const d={1:"前",2:"後"},s={1:"左",2:"中",3:"右"};return`${d[o]}${s[l]}`},Ae=o=>(typeof o=="string"?new Date(o):o).toLocaleDateString("zh-TW"),le=o=>(typeof o=="string"?new Date(o):o).toLocaleString("zh-TW");return Ze(()=>{W(),ge()}),(o,l)=>{const d=el,s=ll,w=al,D=tl,A=ol,S=Me,m=nl,Ie=sl,ae=il,Fe=dl,y=rl,N=Re,q=ul,C=cl,ue=pl,te=fl,H=Be,$=_l,ce=ml,L=vl,P=yl,Le=gl;return c(),E("div",hl,[n("div",Vl,[e(S,null,{header:a(()=>[n("div",wl,[l[25]||(l[25]=n("span",null,"倉庫結構管理",-1)),n("div",null,[e(s,{type:"primary",onClick:l[0]||(l[0]=t=>Z.value=!0)},{default:a(()=>[e(d,null,{default:a(()=>[e(V(se))]),_:1}),l[23]||(l[23]=r(" 新增區域 ",-1))]),_:1}),e(s,{onClick:W},{default:a(()=>[e(d,null,{default:a(()=>[e(V(Ne))]),_:1}),l[24]||(l[24]=r(" 重新整理 ",-1))]),_:1})])])]),default:a(()=>[n("div",kl,[e(A,{data:x.value,props:_e,"node-key":"id","expand-on-click-node":!1,"default-expand-all":!1,class:"storage-tree"},{default:a(({node:t,data:_})=>[n("div",Cl,[n("div",El,[_.type==="area"?(c(),h(d,{key:0,class:"node-icon"},{default:a(()=>[e(V(fe))]),_:1})):_.type==="shelf"?(c(),h(d,{key:1,class:"node-icon"},{default:a(()=>[e(V(je))]),_:1})):_.type==="floor"?(c(),h(d,{key:2,class:"node-icon"},{default:a(()=>[e(V(Ge))]),_:1})):(c(),h(d,{key:3,class:"node-icon"},{default:a(()=>[e(V(Oe))]),_:1})),n("span",$l,u(_.label),1),_.capacity!==void 0?(c(),h(w,{key:4,size:"small",type:"info"},{default:a(()=>[r(u(_.used||0)+"/"+u(_.capacity),1)]),_:2},1024)):j("",!0),_.utilization!==void 0?(c(),h(w,{key:5,size:"small",type:qe(_.utilization)},{default:a(()=>[r(u(Math.round(_.utilization))+"% ",1)]),_:2},1032,["type"])):j("",!0)]),n("div",xl,[_.type==="floor"?(c(),h(D,{key:0},{default:a(()=>[e(s,{size:"small",type:"primary",onClick:ie(U=>$e(_),["stop"])},{default:a(()=>[e(d,null,{default:a(()=>[e(V(We))]),_:1})]),_:1},8,["onClick"]),e(s,{size:"small",type:"warning",onClick:ie(U=>xe(_),["stop"]),disabled:_.used>0},{default:a(()=>[e(d,null,{default:a(()=>[e(V(He))]),_:1})]),_:1},8,["onClick","disabled"])]),_:2},1024)):_.children&&_.children.length>0?(c(),h(s,{key:1,size:"small",onClick:ie(U=>Ue(t),["stop"])},{default:a(()=>[e(d,null,{default:a(()=>[e(V(Ke))]),_:1})]),_:1},8,["onClick"])):j("",!0)])])]),_:1},8,["data"])])]),_:1})]),n("div",Sl,[e(S,null,{header:a(()=>[n("div",Ul,[n("span",null,"待入庫物料 ("+u(z.value.length)+" 項)",1),n("div",null,[e(s,{type:"success",onClick:Ee,disabled:!T.value.length},{default:a(()=>[e(d,null,{default:a(()=>[e(V(Je))]),_:1}),l[26]||(l[26]=r(" 批量入庫 ",-1))]),_:1},8,["disabled"])])])]),default:a(()=>[Qe((c(),h(ae,{data:z.value,onSelectionChange:be,stripe:""},{default:a(()=>[e(m,{type:"selection",width:"55"}),e(m,{prop:"item_name",label:"物料名稱",width:"200"}),e(m,{prop:"quantity",label:"數量",width:"120",align:"right"},{default:a(({row:t})=>[r(u(t.quantity)+" "+u(t.unit),1)]),_:1}),e(m,{prop:"source_po_number",label:"來源採購單號",width:"150"},{default:a(({row:t})=>[e(Ie,{type:"primary",onClick:_=>ze(t.source_po_number)},{default:a(()=>[r(u(t.source_po_number),1)]),_:2},1032,["onClick"])]),_:1}),e(m,{prop:"arrival_date",label:"到貨時間",width:"150"},{default:a(({row:t})=>[r(u(le(t.arrival_date)),1)]),_:1}),e(m,{prop:"receiver",label:"收貨人",width:"100"}),e(m,{label:"操作",width:"150"},{default:a(({row:t})=>[e(s,{size:"small",type:"primary",onClick:_=>ke(t)},{default:a(()=>[e(d,null,{default:a(()=>[e(V(fe))]),_:1}),l[27]||(l[27]=r(" 指定儲位 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Le,K.value]])]),_:1})]),n("div",zl,[e(S,null,{header:a(()=>[n("div",ql,[l[29]||(l[29]=n("span",null,"手動入庫管理",-1)),e(s,{type:"primary",onClick:l[1]||(l[1]=t=>R.value=!0)},{default:a(()=>[e(d,null,{default:a(()=>[e(V(se))]),_:1}),l[28]||(l[28]=r(" 手動入庫 ",-1))]),_:1})])]),default:a(()=>[n("div",Dl,[e(Fe,{title:"手動入庫用於直接將物料加入庫存，不需要先經過收貨流程。適用於調撥、盤點或特殊情況。",type:"info","show-icon":"",closable:!1})])]),_:1})]),n("div",Al,[e(N,{gutter:20},{default:a(()=>[e(y,{span:6},{default:a(()=>[e(S,{class:"stat-card"},{default:a(()=>[n("div",Il,[n("div",Fl,u(ee.value.totalPositions),1),l[30]||(l[30]=n("div",{class:"stat-label"},"總儲位數",-1))])]),_:1})]),_:1}),e(y,{span:6},{default:a(()=>[e(S,{class:"stat-card"},{default:a(()=>[n("div",Ll,[n("div",Pl,u(ee.value.usedPositions),1),l[31]||(l[31]=n("div",{class:"stat-label"},"已使用",-1))])]),_:1})]),_:1}),e(y,{span:6},{default:a(()=>[e(S,{class:"stat-card"},{default:a(()=>[n("div",Tl,[n("div",Zl,u(ee.value.utilizationRate)+"%",1),l[32]||(l[32]=n("div",{class:"stat-label"},"使用率",-1))])]),_:1})]),_:1}),e(y,{span:6},{default:a(()=>[e(S,{class:"stat-card"},{default:a(()=>[n("div",Ml,[n("div",Rl,u(z.value.length),1),l[33]||(l[33]=n("div",{class:"stat-label"},"待入庫",-1))])]),_:1})]),_:1})]),_:1})]),e(H,{modelValue:Z.value,"onUpdate:modelValue":l[5]||(l[5]=t=>Z.value=t),title:"新增區域",width:"750px"},{footer:a(()=>[e(s,{onClick:l[4]||(l[4]=t=>Z.value=!1)},{default:a(()=>[...l[35]||(l[35]=[r("取消",-1)])]),_:1}),e(s,{type:"primary",onClick:we,loading:J.value},{default:a(()=>[...l[36]||(l[36]=[r("創建",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(te,{model:p,rules:me,ref:"createZoneFormRef","label-width":"120px"},{default:a(()=>[e(C,{label:"區域代碼",prop:"area_code"},{default:a(()=>[e(q,{modelValue:p.area_code,"onUpdate:modelValue":l[2]||(l[2]=t=>p.area_code=t),placeholder:"例如: Z1, Z2, Z3"},null,8,["modelValue"])]),_:1}),e(C,{label:"區域名稱"},{default:a(()=>[e(q,{modelValue:p.area_name,"onUpdate:modelValue":l[3]||(l[3]=t=>p.area_name=t),placeholder:"輸入區域名稱"},null,8,["modelValue"])]),_:1}),e(C,{label:"貨架配置"},{default:a(()=>[n("div",Bl,[(c(!0),E(I,null,F(p.shelves,(t,_)=>(c(),E("div",{key:_,class:"shelf-item"},[e(N,{gutter:10,align:"middle"},{default:a(()=>[e(y,{span:4},{default:a(()=>[e(q,{modelValue:t.shelf_code,"onUpdate:modelValue":U=>t.shelf_code=U,placeholder:"代碼",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(y,{span:5},{default:a(()=>[e(ue,{modelValue:t.floors,"onUpdate:modelValue":U=>t.floors=U,min:1,max:10,placeholder:"樓層數",size:"small",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(y,{span:12},{default:a(()=>[e(q,{modelValue:t.description,"onUpdate:modelValue":U=>t.description=U,placeholder:"說明",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(y,{span:3},{default:a(()=>[e(s,{onClick:U=>Ve(_),type:"danger",size:"small",circle:""},{default:a(()=>[e(d,null,{default:a(()=>[e(V(Xe))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),e(s,{onClick:he,type:"primary",size:"small"},{default:a(()=>[e(d,null,{default:a(()=>[e(V(se))]),_:1}),l[34]||(l[34]=r(" 新增貨架 ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(H,{modelValue:M.value,"onUpdate:modelValue":l[10]||(l[10]=t=>M.value=t),title:"指定儲存位置",width:"700px"},{footer:a(()=>[e(s,{onClick:l[9]||(l[9]=t=>M.value=!1)},{default:a(()=>[...l[39]||(l[39]=[r("取消",-1)])]),_:1}),e(s,{type:"primary",onClick:Ce,loading:Q.value,disabled:!ye.value},{default:a(()=>[...l[40]||(l[40]=[r(" 確認入庫 ",-1)])]),_:1},8,["loading","disabled"])]),default:a(()=>[v.value?(c(),E("div",Nl,[n("div",jl,[l[37]||(l[37]=n("h4",null,"物料資訊",-1)),e(ce,{column:2,border:""},{default:a(()=>[e($,{label:"物料名稱"},{default:a(()=>[r(u(v.value.item_name),1)]),_:1}),e($,{label:"規格"},{default:a(()=>[r(u(v.value.specification),1)]),_:1}),e($,{label:"數量"},{default:a(()=>[r(u(v.value.quantity)+" "+u(v.value.unit),1)]),_:1}),e($,{label:"來源採購單號"},{default:a(()=>[r(u(v.value.source_po_number),1)]),_:1}),e($,{label:"到貨時間"},{default:a(()=>[r(u(le(v.value.arrival_date)),1)]),_:1}),e($,{label:"收貨人"},{default:a(()=>[r(u(v.value.receiver),1)]),_:1})]),_:1})]),n("div",Gl,[l[38]||(l[38]=n("h4",null,"選擇儲存位置",-1)),e(te,{model:f,"label-width":"100px"},{default:a(()=>[e(N,{gutter:10},{default:a(()=>[e(y,{span:8},{default:a(()=>[e(C,{label:"區域"},{default:a(()=>[e(P,{modelValue:f.area,"onUpdate:modelValue":l[6]||(l[6]=t=>f.area=t),onChange:de,style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(G.value,t=>(c(),h(L,{key:t.code,label:t.label,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:8},{default:a(()=>[e(C,{label:"貨架"},{default:a(()=>[e(P,{modelValue:f.shelf,"onUpdate:modelValue":l[7]||(l[7]=t=>f.shelf=t),onChange:re,style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(O.value,t=>(c(),h(L,{key:t.code,label:t.label,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:8},{default:a(()=>[e(C,{label:"樓層"},{default:a(()=>[e(P,{modelValue:f.floor,"onUpdate:modelValue":l[8]||(l[8]=t=>f.floor=t),style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(B.value,t=>(c(),h(L,{key:t,label:`第${t}層`,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])):j("",!0)]),_:1},8,["modelValue"]),e(H,{modelValue:R.value,"onUpdate:modelValue":l[20]||(l[20]=t=>R.value=t),title:"手動入庫",width:"700px"},{footer:a(()=>[e(s,{onClick:l[19]||(l[19]=t=>R.value=!1)},{default:a(()=>[...l[41]||(l[41]=[r("取消",-1)])]),_:1}),e(s,{type:"primary",onClick:Se,loading:Y.value},{default:a(()=>[...l[42]||(l[42]=[r("確認入庫",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(te,{model:i,rules:ve,ref:"manualEntryFormRef","label-width":"120px"},{default:a(()=>[e(C,{label:"物料名稱",prop:"item_name"},{default:a(()=>[e(q,{modelValue:i.item_name,"onUpdate:modelValue":l[11]||(l[11]=t=>i.item_name=t),placeholder:"輸入物料名稱"},null,8,["modelValue"])]),_:1}),e(C,{label:"規格",prop:"specification"},{default:a(()=>[e(q,{modelValue:i.specification,"onUpdate:modelValue":l[12]||(l[12]=t=>i.specification=t),placeholder:"輸入物料規格"},null,8,["modelValue"])]),_:1}),e(C,{label:"數量",prop:"quantity"},{default:a(()=>[e(N,{gutter:10},{default:a(()=>[e(y,{span:16},{default:a(()=>[e(ue,{modelValue:i.quantity,"onUpdate:modelValue":l[13]||(l[13]=t=>i.quantity=t),min:1,placeholder:"數量",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(y,{span:8},{default:a(()=>[e(q,{modelValue:i.unit,"onUpdate:modelValue":l[14]||(l[14]=t=>i.unit=t),placeholder:"單位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{label:"儲存位置"},{default:a(()=>[e(N,{gutter:10},{default:a(()=>[e(y,{span:8},{default:a(()=>[e(P,{modelValue:i.area,"onUpdate:modelValue":l[15]||(l[15]=t=>i.area=t),onChange:de,placeholder:"選擇區域",style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(G.value,t=>(c(),h(L,{key:t.code,label:t.label,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(y,{span:8},{default:a(()=>[e(P,{modelValue:i.shelf,"onUpdate:modelValue":l[16]||(l[16]=t=>i.shelf=t),onChange:re,placeholder:"選擇貨架",style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(O.value,t=>(c(),h(L,{key:t.code,label:t.label,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(y,{span:8},{default:a(()=>[e(P,{modelValue:i.floor,"onUpdate:modelValue":l[17]||(l[17]=t=>i.floor=t),placeholder:"選擇樓層",style:{width:"100%"}},{default:a(()=>[(c(!0),E(I,null,F(B.value,t=>(c(),h(L,{key:t,label:`第${t}層`,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{label:"備註"},{default:a(()=>[e(q,{modelValue:i.remarks,"onUpdate:modelValue":l[18]||(l[18]=t=>i.remarks=t),type:"textarea",rows:"3",placeholder:"輸入備註或理由"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(H,{modelValue:X.value,"onUpdate:modelValue":l[22]||(l[22]=t=>X.value=t),title:"儲位詳情",width:"800px"},{footer:a(()=>[e(s,{onClick:l[21]||(l[21]=t=>X.value=!1)},{default:a(()=>[...l[46]||(l[46]=[r("關閉",-1)])]),_:1})]),default:a(()=>[k.value?(c(),E("div",Ol,[n("div",Wl,[l[43]||(l[43]=n("h4",null,"基本資訊",-1)),e(ce,{column:2,border:""},{default:a(()=>[e($,{label:"儲位編號"},{default:a(()=>[r(u(k.value.storage_id),1)]),_:1}),e($,{label:"位置"},{default:a(()=>[r(u(k.value.area_code)+"-"+u(k.value.shelf_code)+"-第"+u(k.value.floor_level)+"層- "+u(De(k.value.front_back_position,k.value.left_middle_right_position)),1)]),_:1}),e($,{label:"狀態"},{default:a(()=>[e(w,{type:k.value.is_active?"success":"danger"},{default:a(()=>[r(u(k.value.is_active?"啟用":"停用"),1)]),_:1},8,["type"])]),_:1}),e($,{label:"建立時間"},{default:a(()=>[r(u(le(k.value.created_at)),1)]),_:1})]),_:1})]),n("div",Hl,[l[44]||(l[44]=n("h4",null,"庫存資訊",-1)),e(ae,{data:k.value.inventory,size:"small"},{default:a(()=>[e(m,{prop:"item_id",label:"物料名稱"}),e(m,{prop:"current_quantity",label:"数量",width:"100"}),e(m,{prop:"source_no",label:"來源單號",width:"120"}),e(m,{prop:"source_line",label:"明細行",width:"80"})]),_:1},8,["data"])]),n("div",Kl,[l[45]||(l[45]=n("h4",null,"異動履歷",-1)),e(ae,{data:k.value.movements,size:"small","max-height":"300"},{default:a(()=>[e(m,{prop:"operation_date",label:"日期",width:"120"},{default:a(({row:t})=>[r(u(Ae(t.operation_date)),1)]),_:1}),e(m,{prop:"operation_type",label:"操作",width:"80"},{default:a(({row:t})=>[e(w,{type:t.operation_type==="in"?"success":"warning",size:"small"},{default:a(()=>[r(u(t.operation_type==="in"?"入庫":"出庫"),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"item_id",label:"物料"}),e(m,{prop:"quantity",label:"數量",width:"100",align:"right"}),e(m,{prop:"operator_name",label:"操作人",width:"100"}),e(m,{prop:"note",label:"備註"})]),_:1},8,["data"])])])):j("",!0)]),_:1},8,["modelValue"])])}}});const ga=bl(Jl,[["__scopeId","data-v-5a5cdc95"],["__file","D:/AWORKSPACE/Github/project_ERP_dev_agent/frontend/src/views/inventory/Storage.vue"]]);export{ga as default};
//# sourceMappingURL=Storage-4d982f78.js.map
