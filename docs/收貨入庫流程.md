# 收貨入庫驗收領用流程

prompt:

接下來我敘述收貨與驗收管理與進入庫存的操作 你將我敘述給你的用你理解的白話文敘述給我聽，以此對齊我們的想法 再交期維護之後工程師以及採購人員以及專案經理不確定誰會在收貨地點辦公，因此任誰都可以收貨，當從物流司機手上接到貨物，點開收貨管理系統，應該看到國內或國外兩種列表，如果是國內通常可以看到是"特定供應商"，因此列表讓人員可以國內>以供應商去篩。 然後去看該供應商的採購單(可能有多張)，並展示1~多張採購單，每張採購單展示第一項採購的item，讓人員打開紙箱，就可以與系統上的採購單第一項item比對，看是哪一張採購單送來了。此時人員可以點開該張採購單，針對裡面每一項item與出貨單上面的內容，一一看一下每個item去比對確實收到，並對該item點下確認收貨。當收貨之後系統要記錄收貨人是哪個user確認的，當Item的"確認收貨"被按下去之後，狀態要變成已到貨 接下來就會從交期維護那邊離開 並且如果變成已到貨的話要再待入庫列表那邊出現 並從待收貨列表中移除 待入庫列表，人員可以看到確認收下來的Item，對其"分配位置"，將該Item放到特定儲位。目前實際倉儲空間是有分區域 每個區域會有架子 架子排序是ABCDE這樣排 有可能是Zone1有A架子B架子 Zone2有C架子D架子這樣的規則 美個架子預設都是6層，每層有前後空間可以選，前後各自有左中右的位置可以選，因此人員在分配位置的設定流程是->點選Item分配位置操作->選擇區域->選擇架子->選擇層數->選擇前後->選擇左中右 確認擺放。 此時這個資訊就被寫入Item的倉儲位號，並更改Item狀態為"已入庫" 儲存位置設定可以新增、刪除、編輯 區域編號、區域名稱(中文)、架子編號、架子名稱(中文)、架子層數(整數) 可能有一些物品沒有走系統流程買回來的，此時需要有一個快速新增庫存功能 人員可以快速輸入Item名稱、規格、用途、備註、存入倉庫的位置(依樣是從區域->架子->層數->前後->左中右)這樣選下來。 接下來需要請購人，到"我的請購"頁面，查看他自己到貨的物品有哪些，因為請購人跟收貨人可能不是同一位，因此為了要讓請購當事人確實知道他的東西到了，該Item從已到貨到已入庫這個狀態階段，在請購當事人系統上的"我的請購"頁面，就可以看到他的物品的待驗收欄位出現可以"驗收"的操作按鈕，在請購人確認物品的存在以及符合需求後就可以按下驗收。此時一個Item就算完整的被請購->採購->物流->收貨->入庫+驗收 or 驗收+入庫 (驗收跟入庫可以順序調換 ) 然後是出庫領用 庫存管理頁面除了快速新增庫存之外 還要有一個查詢與領用庫存 這個頁面人員可以透過物品名稱[支援模糊搜尋]or請購單號or倉庫位置[支持倉儲位置路由搜尋]or採購單號or物品規格[支持模糊搜尋]or物品用途(日常或專案)去快速篩選出人員想知道的Item放在哪個儲位，支持倉儲位置路由搜尋的意思是 可以選擇Zone1 就跳出Zone1所有架子的所有層的所有物品 如果選擇Zone1/A就跳出Zone1的A架子的所有物品，如果選擇Zone1/A/1的話就篩選出Zone1區域的A架子的第一層的所有物品以此類推 人員可以用物品名稱與物品規格為依據去搜尋，並且有輸入欄位可以輸入幾個字跳出幾個最相近的選項在下拉式選單供人員快速選到他想要的物品。 搜出來的結果在列表上顯示幾個重點 1.物品名稱2.規格3.庫存數量4.用途5.庫存位置 如果一個物品有多個 被放在不同位置 必須分開顯示 並顯示在該位置的數量 在查詢結果的Item欄位上要有領用的操作 點下去可以選擇數量(1以上的正整數)，在確認。 確認按下去之後 系統紀錄是哪位user點下領用按鈕 以及出庫的時間，並更新到該倉庫位置的該物品的數量。

### 1. 收貨

- 不管是工程師、採購或專案經理，只要人在收貨地點，都可以進入「收貨管理系統」。
- 收貨管理分成「國內」和「國外」兩類清單：
    - **國內**：通常會先以「供應商」為篩選條件，看到該供應商名下所有未到貨的採購單。
    - 系統會展示一個採購單列表，每張單顯示第一個 Item，方便收貨人員對照紙箱內容來確認是哪一張單的貨。
- 點開某張採購單後，收貨人要逐一比對出貨單與採購單的每個 Item，確認收到就按「確認收貨」。
- 當某個 Item 被確認收貨：
    - 系統記錄「哪個 User 收貨、收貨時間」。
    - 該 Item 狀態變成 **已到貨**。
    - 該 Item 從「交期維護」頁消失，轉移到「待入庫」列表。

---

### 2. 入庫

- 「待入庫列表」會展示所有已到貨、但尚未分配儲位的 Item。
- 人員點選某個 Item → 進入「分配位置」操作，流程是：
    - 選擇區域（Zone1/Zone2...）
    - 選擇架子（A, B, C...）
    - 選擇層數（1~6）
    - 選擇前/後
    - 選擇左/中/右
        
        → 確定儲位。
        
- 系統會把該位置記錄到 `Item.storage_location_code`，並將 Item 狀態改為 **已入庫**。
- **庫存結構**（可管理）：
    - 區域（Zone）：可新增/刪除/編輯，帶中文名稱。
    - 架子（Shelf）：每個區域可有多個架子，帶中文名稱。
    - 層數（Floor）：整數。
    - 前後（1/2），左右中（1/2/3）。
- **快速新增庫存**：針對不是走請購/採購流程的物品，提供一個表單，輸入名稱、規格、用途、備註，再直接指定儲位。

---

### 3. 驗收

- 請購人進入「我的請購」頁面，會看到屬於自己請購的物品。
- 當物品已「到貨」或「入庫」時，在「我的請購」會出現「待驗收」操作。
- 請購人確認該物品確實到貨且符合需求後，點「驗收」：
    - 系統記錄驗收人與驗收日期。
    - Item 狀態變成 **已驗收**。
    - 流程上，驗收與入庫順序可以對調：
        - **收貨→入庫→驗收**，或
        - **收貨→驗收→入庫**，都成立。

---

### 4. 領用（出庫）

- 「庫存管理」頁提供查詢與領用功能：
    - 搜尋條件：物品名稱（模糊）、請購單號、採購單號、物品規格（模糊）、用途（日常/專案）、或倉庫位置（支援逐層展開：Zone1 → Zone1/A → Zone1/A/1 ...）。
    - 搜尋結果顯示：物品名稱、規格、庫存數量、用途、庫存位置。
    - 如果一個物品放在多個位置，要逐筆顯示，並列出各位置數量。
- 在查詢結果裡，每個 Item 都有「領用」操作：
    - 人員輸入領用數量（正整數 ≥1）。
    - 按下確認後：
        - 系統記錄「哪位 User 領用、時間」。
        - 減少該儲位的庫存數量。

flowchart TD
  %% =========================
  %% 收貨 → 入庫 → 驗收 → 領用（出庫）
  %% =========================

  %% 收貨
  A[開啟「收貨管理」] --> B{選擇清單}
  B -->|國內| B1[依供應商篩選]
  B -->|國外| B2[依供應商/集運倉篩選]
  B1 --> C[顯示該供應商之未到貨採購單列表（每張顯示第一項 Item 供對箱）]
  B2 --> C
  C --> D[點開某張採購單]
  D --> E[逐項比對出貨單與採購單 Item]
  E --> F[對單一 Item 按「確認收貨」]
  F --> G[記錄：收貨人User、時間]
  G --> H[狀態：Item → 已到貨]
  H --> I[從「交期維護」移除，加入「待入庫列表」]

  %% 入庫（分配儲位）
  I --> J[進入「待入庫列表」]
  J --> K[選擇要入庫的 Item]
  K --> L[分配位置：區域 → 架子 → 層數 → 前/後 → 左/中/右]
  L --> M[寫入 storage_location_code]
  M --> N[狀態：Item → 已入庫]

  %% 驗收（請購人）
  %% 驗收可先於入庫或後於入庫，兩條進入點
  H -.-> O[請購人「我的請購」看到待驗收]
  N -.-> O
  O --> P[點「驗收」]
  P --> Q[記錄：驗收人User、日期]
  Q --> R[驗收狀態：accepted]

  %% 庫存查詢與領用（出庫）
  N --> S[進入「庫存管理」]
  R --> S
  S --> T{篩選條件}
  T -->|物品名稱（模糊）| U[查詢結果]
  T -->|規格（模糊）| U
  T -->|請購單號| U
  T -->|採購單號| U
  T -->|用途（日常/專案）| U
  T -->|倉庫位置路由：Zone → 架子 → 層| U

  U --> V[結果列表：名稱 / 規格 / 庫存數量 / 用途 / 位置（多位置分筆顯示）]
  V --> W[點某筆 Item 的「領用」]
  W --> X[輸入領用數量（正整數 ≥ 1）]
  X --> Y[按「確認領用」]
  Y --> Z[記錄：領用人User、時間、領用數量]
  Z --> ZA[更新該位置庫存數量（扣減）]

  %% 輔助：快速新增庫存（非流程採購物品）
  S --> QN[快速新增庫存：輸入名稱/規格/用途/備註 → 指定儲位（區域/架子/層/前後/左右）]
  QN --> N

  %% 節點樣式（可略）
  classDef op fill:#eef,stroke:#88a,stroke-width:1px;
  classDef state fill:#efe,stroke:#7a7,stroke-width:1px;
  classDef record fill:#ffe,stroke:#cc9,stroke-width:1px;

  class A,B,B1,B2,C,D,E,F,J,K,L,S,T,U,V,W,X,QN op;
  class G,Q,Y,Z,ZA,M record;
  class H,I,N,O,P,R state;