---

## User (用戶)

- 用途：系統使用者帳號與角色管理。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| user_id | SERIAL PK | 主鍵 |
| chinese_name | VARCHAR(100) | 中文姓名 |
| username | VARCHAR(50) UNIQUE | 登入帳號 |
| password | VARCHAR(255) | 加密密碼 |
| department | VARCHAR(100) | 所屬部門 |
| role | VARCHAR(50) | 權限角色 |

---

## Supplier (供應商)

- 用途：供應商基本資料。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| supplier_id | VARCHAR(50) PK | 供應商編號 |
| supplier_name_zh | VARCHAR(200) | 中文名稱 |
| supplier_name_en | VARCHAR(200) | 英文名稱 |
| supplier_address | TEXT | 地址 |
| supplier_phone | VARCHAR(50) | 電話 |
| supplier_email | VARCHAR(100) | 信箱 |
| supplier_contact_person | VARCHAR(100) | 聯絡人 |
| supplier_tax_id | VARCHAR(20) | 統一編號 |
| supplier_region | ENUM(domestic, international) | 國內/國外 |
| supplier_remark | TEXT | 備註 |
| payment_terms | VARCHAR(200) | 付款條件 |
| bank_account | VARCHAR(50) | 銀行帳號 |

---

## ItemCategory (物品類別)

- 用途：管理物品類別與代碼。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| category_id | SERIAL PK | 類別編號 |
| category_code | VARCHAR(10) | 類別代碼 (01, 02...) |
| category_name | VARCHAR(100) | 類別名稱 |
| sort_order | INT | 排序順序 |
| is_active | BOOLEAN | 是否啟用 |
| created_at | TIMESTAMP | 建立時間 |
| updated_at | TIMESTAMP | 更新時間 |

---

## Request_Order (請購單)

- 用途：工程師提出請購需求的單頭。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| request_order_no | VARCHAR(50) PK | 請購單號 |
| requester_id | INT FK→user | 請購人 ID |
| requester_name | VARCHAR(100) | 請購人姓名 |
| usage_type | ENUM(daily, project) | 用途 |
| project_id | VARCHAR(50) | 專案編號 |
| submit_date | DATE | 提交日期 |
| order_status | ENUM(draft, submitted, reviewed) | 狀態 |

---

## Request_Order_Item (請購單物品)

- 用途：請購單的物品明細。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| detail_id | SERIAL PK | 明細編號 |
| request_order_no | VARCHAR(50) FK→request_order | 請購單號 |
| item_name | VARCHAR(200) | 物品名稱 |
| item_quantity | NUMERIC(10,2) | 數量（正整數檢核） |
| item_unit | VARCHAR(20) | 單位 |
| item_specification | TEXT | 規格 |
| item_description | TEXT | 描述 |
| item_category | VARCHAR(10) | 類別代碼 |
| item_status | ENUM(pending_review, approved, rejected, questioned, unavailable, order_created, purchased, shipped, arrived, warehoused, issued) | 狀態 |
| acceptance_status | ENUM(pending_acceptance, accepted) | 驗收狀態 |
| supplier_id | VARCHAR(50) | 供應商編號 |
| unit_price | NUMERIC(10,2) | 單價 |
| material_serial_no | VARCHAR(50) | 物料序號 |
| status_note | TEXT | 狀態備註 |
| needs_acceptance | BOOLEAN | 是否需驗收 |

---

## Purchase_Order (採購單)

- 用途：依供應商彙整請購明細生成的採購單。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| purchase_order_no | VARCHAR(50) PK | 採購單號 |
| supplier_name | VARCHAR(200) | 供應商名稱 |
| supplier_address | TEXT | 供應商地址 |
| contact_phone | VARCHAR(50) | 聯絡電話 |
| contact_person | VARCHAR(100) | 聯絡人 |
| supplier_tax_id | VARCHAR(20) | 統一編號 |
| order_date | DATE | 訂購日期 |
| quotation_no | VARCHAR(50) | 報價單號 |
| delivery_address | TEXT | 收貨地址 |
| creation_date | DATE | 製單日期 |
| creator_id | INT | 製單人 |
| output_person_id | INT | 輸出人 |
| notes | TEXT | 注意事項 |
| confirm_purchaser_id | INT | 確認採購人 |
| purchase_status | ENUM(order_created, purchased) | 採購狀態 |
| shipping_status | ENUM(none, shipped, in_transit, customs_clearance, expected_arrival, arrived) | 交期狀態 |
| shipped_at | TIMESTAMP | 出貨日期 |
| eta_date | DATE | 預計到貨日 |
| arrival_date | DATE | 實際到貨日 |
| carrier | VARCHAR(100) | 物流業者 |
| tracking_no | VARCHAR(100) | 追蹤碼 |
| logistics_note | TEXT | 備註 |
| subtotal_int | INTEGER | 未稅總額（整數） |
| tax_decimal1 | NUMERIC(12,1) | 稅額（一位小數） |
| grand_total_int | INTEGER | 含稅總額（整數） |

---

## Purchase_Order_Item (採購單物品)

- 用途：採購單的物品明細。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| detail_id | SERIAL PK | 明細編號 |
| purchase_order_no | VARCHAR(50) FK→purchase_order | 採購單號 |
| item_name | VARCHAR(200) | 物品名稱 |
| item_quantity | NUMERIC(10,2) | 數量（正整數檢核） |
| item_unit | VARCHAR(20) | 單位 |
| unit_price | NUMERIC(10,2) | 單價 |
| item_specification | TEXT | 規格 |
| item_model | VARCHAR(100) | 型號 |
| line_status | ENUM(order_created, purchased, shipped, arrived) | 狀態 |
| line_subtotal_int | INTEGER | 小計（整數） |
| source_request_order_no | VARCHAR(50) | 來源請購單號 |
| source_detail_id | INT | 來源請購單明細 |

---

## Shipment_Consolidation (集運倉)

- 用途：海外供應商採購單合併管理。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| consolidation_id | VARCHAR(50) PK | 集運倉編號 |
| name | VARCHAR(200) | 集運倉名稱 |
| region | ENUM(domestic, international) | 區域 |
| status | ENUM(planning, shipped, in_transit, customs_clearance, expected_arrival, arrived, closed) | 狀態 |
| shipped_at | TIMESTAMP | 出貨日期 |
| eta_date | DATE | 預計到貨日 |
| arrival_date | DATE | 實際到貨日 |
| carrier | VARCHAR(100) | 物流業者 |
| tracking_no | VARCHAR(100) | 追蹤碼 |
| logistics_note | TEXT | 備註 |
| created_at | TIMESTAMP | 建立時間 |
| updated_at | TIMESTAMP | 更新時間 |

---

## Consolidation_PO (集運倉與採購單關聯)

- 用途：多張採購單對應到同一個集運倉。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| id | SERIAL PK | 主鍵 |
| consolidation_id | VARCHAR(50) FK→shipment_consolidation | 集運倉編號 |
| purchase_order_no | VARCHAR(50) FK→purchase_order | 採購單號 |
| added_at | TIMESTAMP | 加入時間 |

---

## Logistics_Event (交期事件)

- 用途：交期維護的事件流水，記錄狀態變更。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| event_id | SERIAL PK | 主鍵 |
| scope_type | ENUM(PO, CONSOLIDATION) | 事件範圍 |
| scope_id | VARCHAR(50) | 採購單號或集運倉編號 |
| status | ENUM(shipped, in_transit, customs_clearance, expected_arrival, arrived) | 狀態 |
| happened_at | TIMESTAMP | 發生時間 |
| note | TEXT | 備註 |
| created_by | INT FK→user | 建立人 |
| created_at | TIMESTAMP | 建立時間 |

---

## Storage (儲位)

- 用途：管理倉庫儲位結構。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| storage_id | VARCHAR(20) PK | 儲位編號 |
| area_code | VARCHAR(10) | 區域編號 |
| shelf_code | CHAR(1) | 貨架代碼 |
| floor_level | INT | 層數 |
| front_back_position | INT | 前後位置 |
| left_middle_right_position | INT | 左中右位置 |

---

## Storage_History (儲位歷史紀錄)

- 用途：物品進出庫紀錄。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| history_id | SERIAL PK | 紀錄編號 |
| storage_id | VARCHAR(20) FK→storage | 儲位編號 |
| item_id | VARCHAR(50) | 物品編號 |
| operation_type | ENUM(in, out) | 類型 |
| operation_date | TIMESTAMP | 操作時間 |
| operator_id | INT FK→user | 操作人 |
| quantity | NUMERIC(10,2) | 數量 |
| source_type | VARCHAR(30) | 來源單據類型 |
| source_no | VARCHAR(50) | 來源單號 |
| source_line | INT | 來源明細 |

---

## Project (專案)

- 用途：專案資料管理。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| project_id | VARCHAR(50) PK | 專案編號 |
| project_name | VARCHAR(200) | 專案名稱 |
| project_status | ENUM(ongoing, completed) | 狀態 |
| start_date | DATE | 開始日期 |
| end_date | DATE | 結束日期 |
| total_expenditure | NUMERIC(15,2) | 總支出 |
| customer_name | VARCHAR(200) | 客戶名稱 |
| customer_contact | VARCHAR(100) | 聯絡人 |
| customer_address | TEXT | 地址 |
| customer_phone | VARCHAR(50) | 電話 |
| customer_department | VARCHAR(100) | 所屬部門 |

---

## Project_Supplier_Expenditure (專案供應商支出)

- 用途：專案與供應商支出關聯。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| record_id | SERIAL PK | 主鍵 |
| project_id | VARCHAR(50) FK→project | 專案編號 |
| supplier_id | VARCHAR(50) FK→supplier | 供應商編號 |
| expenditure_amount | NUMERIC(15,2) | 支出金額 |

---

## SystemSettings (系統設定)

- 用途：系統層級設定，例如稅率。

| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| setting_id | SERIAL PK | 主鍵 |
| setting_type | VARCHAR(50) | 類型 |
| setting_key | VARCHAR(100) | 鍵 |
| setting_value | TEXT | 值 |
| setting_description | TEXT | 描述 |
| created_at | TIMESTAMP | 建立時間 |
| updated_at | TIMESTAMP | 更新時間 |